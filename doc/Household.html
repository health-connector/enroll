<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Household
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Household";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index (H)</a> &raquo;
    
    
    <span class="title">Household</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Household
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Household</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd><span class='object_link'><a href="HasFamilyMembers.html" title="HasFamilyMembers (module)">HasFamilyMembers</a></span>, Mongoid::Document, Mongoid::Timestamps, <span class='object_link'><a href="SetCurrentUser.html" title="SetCurrentUser (module)">SetCurrentUser</a></span></dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/household.rb</dd>
  </dl>
  
</div>


  <h2>Constant Summary</h2>
  <dl class="constants">
    
      <dt id="ImmediateFamily-constant" class="">ImmediateFamily =
        
      </dt>
      <dd><pre class="code"><span class='qwords_beg'>%w{</span><span class='tstring_content'>self</span><span class='words_sep'> </span><span class='tstring_content'>spouse</span><span class='words_sep'> </span><span class='tstring_content'>life_partner</span><span class='words_sep'> </span><span class='tstring_content'>child</span><span class='words_sep'> </span><span class='tstring_content'>ward</span><span class='words_sep'> </span><span class='tstring_content'>foster_child</span><span class='words_sep'> </span><span class='tstring_content'>adopted_child</span><span class='words_sep'> </span><span class='tstring_content'>stepson_or_stepdaughter</span><span class='words_sep'> </span><span class='tstring_content'>stepchild</span><span class='words_sep'> </span><span class='tstring_content'>domestic_partner</span><span class='words_sep'>}</span></pre></dd>
    
  </dl>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#active_hbx_enrollments-instance_method" title="#active_hbx_enrollments (instance method)">#<strong>active_hbx_enrollments</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>after_build :build_irs_group.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#active_hbx_enrollments_with_aptc_by_year-instance_method" title="#active_hbx_enrollments_with_aptc_by_year (instance method)">#<strong>active_hbx_enrollments_with_aptc_by_year</strong>(year)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#active_thh_with_year-instance_method" title="#active_thh_with_year (instance method)">#<strong>active_thh_with_year</strong>(year)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_household_coverage_member-instance_method" title="#add_household_coverage_member (instance method)">#<strong>add_household_coverage_member</strong>(family_member)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_tax_household_family_member-instance_method" title="#add_tax_household_family_member (instance method)">#<strong>add_tax_household_family_member</strong>(family_member, verified_tax_household_member)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#applicant_ids-instance_method" title="#applicant_ids (instance method)">#<strong>applicant_ids</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_or_update_tax_household_from_primary-instance_method" title="#build_or_update_tax_household_from_primary (instance method)">#<strong>build_or_update_tax_household_from_primary</strong>(verified_primary_family_member, primary_person, active_verified_household)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>def determination_split_coverage_household   hh =
coverage_household.find_or_initialize_by(is_determination_split_household:
true)   hh.submitted_at ||= DateTime.current   hh end.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_thh_and_eligibility-instance_method" title="#build_thh_and_eligibility (instance method)">#<strong>build_thh_and_eligibility</strong>(max_aptc, csr, date, slcsp)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_hbx_enrollment_from-instance_method" title="#create_hbx_enrollment_from (instance method)">#<strong>create_hbx_enrollment_from</strong>(employee_role: nil, coverage_household: nil, benefit_group: nil, benefit_group_assignment: nil, consumer_role: nil, benefit_package: nil, submitted_at: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_hbx_enrollment-instance_method" title="#delete_hbx_enrollment (instance method)">#<strong>delete_hbx_enrollment</strong>(hbx_enrollment_id)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#effective_ending_on_gt_effective_starting_on-instance_method" title="#effective_ending_on_gt_effective_starting_on (instance method)">#<strong>effective_ending_on_gt_effective_starting_on</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eligibility_determinations_for_year-instance_method" title="#eligibility_determinations_for_year (instance method)">#<strong>eligibility_determinations_for_year</strong>(year)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#end_multiple_thh-instance_method" title="#end_multiple_thh (instance method)">#<strong>end_multiple_thh</strong>(options = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#enrolled_hbx_enrollments-instance_method" title="#enrolled_hbx_enrollments (instance method)">#<strong>enrolled_hbx_enrollments</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#enrolled_including_waived_hbx_enrollments-instance_method" title="#enrolled_including_waived_hbx_enrollments (instance method)">#<strong>enrolled_including_waived_hbx_enrollments</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#extended_family_coverage_household-instance_method" title="#extended_family_coverage_household (instance method)">#<strong>extended_family_coverage_household</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hbx_enrollments_with_aptc_by_date-instance_method" title="#hbx_enrollments_with_aptc_by_date (instance method)">#<strong>hbx_enrollments_with_aptc_by_date</strong>(date)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#hbx_enrollments_with_aptc_by_year-instance_method" title="#hbx_enrollments_with_aptc_by_year (instance method)">#<strong>hbx_enrollments_with_aptc_by_year</strong>(year)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#immediate_family_coverage_household-instance_method" title="#immediate_family_coverage_household (instance method)">#<strong>immediate_family_coverage_household</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#irs_group-instance_method" title="#irs_group (instance method)">#<strong>irs_group</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#irs_group=-instance_method" title="#irs_group= (instance method)">#<strong>irs_group=</strong>(new_irs_group)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#is_active%3F-instance_method" title="#is_active? (instance method)">#<strong>is_active?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#latest_active_tax_household-instance_method" title="#latest_active_tax_household (instance method)">#<strong>latest_active_tax_household</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#latest_active_tax_household_with_year-instance_method" title="#latest_active_tax_household_with_year (instance method)">#<strong>latest_active_tax_household_with_year</strong>(year)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#latest_active_thh-instance_method" title="#latest_active_thh (instance method)">#<strong>latest_active_thh</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#latest_active_thh_with_year-instance_method" title="#latest_active_thh_with_year (instance method)">#<strong>latest_active_thh_with_year</strong>(year)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#latest_coverage_household-instance_method" title="#latest_coverage_household (instance method)">#<strong>latest_coverage_household</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#latest_tax_household_with_year-instance_method" title="#latest_tax_household_with_year (instance method)">#<strong>latest_tax_household_with_year</strong>(year)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_hbx_enrollment_from-instance_method" title="#new_hbx_enrollment_from (instance method)">#<strong>new_hbx_enrollment_from</strong>(employee_role: nil, coverage_household: nil, benefit_group: nil, benefit_group_assignment: nil, resident_role: nil, consumer_role: nil, benefit_package: nil, qle: false, submitted_at: nil, coverage_start: nil, enrollment_kind: nil, external_enrollment: false, opt_effective_on: nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#parent-instance_method" title="#parent (instance method)">#<strong>parent</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_family_member-instance_method" title="#remove_family_member (instance method)">#<strong>remove_family_member</strong>(member)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#renewing_hbx_enrollments-instance_method" title="#renewing_hbx_enrollments (instance method)">#<strong>renewing_hbx_enrollments</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#renewing_individual_market_hbx_enrollments-instance_method" title="#renewing_individual_market_hbx_enrollments (instance method)">#<strong>renewing_individual_market_hbx_enrollments</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset_is_active_for_previous-instance_method" title="#reset_is_active_for_previous (instance method)">#<strong>reset_is_active_for_previous</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_effective_ending_on-instance_method" title="#set_effective_ending_on (instance method)">#<strong>set_effective_ending_on</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This will set the effective_ending_on of previously active household to 1
day before start of the current household&#39;s effective_starting_on.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_effective_starting_on-instance_method" title="#set_effective_starting_on (instance method)">#<strong>set_effective_starting_on</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_submitted_at-instance_method" title="#set_submitted_at (instance method)">#<strong>set_submitted_at</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="HasFamilyMembers.html" title="HasFamilyMembers (module)">HasFamilyMembers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="HasFamilyMembers.html#family_members-instance_method" title="HasFamilyMembers#family_members (method)">#family_members</a></span>, <span class='object_link'><a href="HasFamilyMembers.html#people-instance_method" title="HasFamilyMembers#people (method)">#people</a></span></p>

  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="SetCurrentUser.html" title="SetCurrentUser (module)">SetCurrentUser</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="SetCurrentUser.html#included-class_method" title="SetCurrentUser.included (method)">included</a></span>, <span class='object_link'><a href="SetCurrentUser.html#save_user-instance_method" title="SetCurrentUser#save_user (method)">#save_user</a></span>, <span class='object_link'><a href="SetCurrentUser.html#update_user-instance_method" title="SetCurrentUser#update_user (method)">#update_user</a></span></p>

  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="active_hbx_enrollments-instance_method">
  
    #<strong>active_hbx_enrollments</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>after_build :build_irs_group</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


36
37
38
39
40
41
42
43
44
45
46
47</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 36</span>

<span class='kw'>def</span> <span class='id identifier rubyid_active_hbx_enrollments'>active_hbx_enrollments</span>
  <span class='id identifier rubyid_actives'>actives</span> <span class='op'>=</span> <span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lparen'>(</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_list'>list</span><span class='comma'>,</span> <span class='id identifier rubyid_enrollment'>enrollment</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_enrollment'>enrollment</span><span class='period'>.</span><span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span>
       <span class='lparen'>(</span><span class='id identifier rubyid_enrollment'>enrollment</span><span class='period'>.</span><span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_active_year'>active_year</span> <span class='op'>&gt;=</span> <span class='const'><span class='object_link'><a href="TimeKeeper.html" title="TimeKeeper (class)">TimeKeeper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_date_of_record'><span class='object_link'><a href="TimeKeeper.html#date_of_record-class_method" title="TimeKeeper.date_of_record (method)">date_of_record</a></span></span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span>
       <span class='lparen'>(</span><span class='const'><span class='object_link'><a href="HbxEnrollment.html" title="HbxEnrollment (class)">HbxEnrollment</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="HbxEnrollment.html#ENROLLED_STATUSES-constant" title="HbxEnrollment::ENROLLED_STATUSES (constant)">ENROLLED_STATUSES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_enrollment'>enrollment</span><span class='period'>.</span><span class='id identifier rubyid_aasm_state'>aasm_state</span><span class='rparen'>)</span><span class='rparen'>)</span>

      <span class='id identifier rubyid_list'>list</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_enrollment'>enrollment</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_list'>list</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_actives'>actives</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="active_hbx_enrollments_with_aptc_by_year-instance_method">
  
    #<strong>active_hbx_enrollments_with_aptc_by_year</strong>(year)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


382
383
384</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 382</span>

<span class='kw'>def</span> <span class='id identifier rubyid_active_hbx_enrollments_with_aptc_by_year'>active_hbx_enrollments_with_aptc_by_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_active'>active</span><span class='period'>.</span><span class='id identifier rubyid_enrolled'>enrolled</span><span class='period'>.</span><span class='id identifier rubyid_with_aptc'>with_aptc</span><span class='period'>.</span><span class='id identifier rubyid_by_year'>by_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>changing:</span> <span class='kw'>false</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_entries'>entries</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="active_thh_with_year-instance_method">
  
    #<strong>active_thh_with_year</strong>(year)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


226
227
228</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 226</span>

<span class='kw'>def</span> <span class='id identifier rubyid_active_thh_with_year'>active_thh_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_with_year'>tax_household_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_active_tax_household'>active_tax_household</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_household_coverage_member-instance_method">
  
    #<strong>add_household_coverage_member</strong>(family_member)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 57</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_household_coverage_member'>add_household_coverage_member</span><span class='lparen'>(</span><span class='id identifier rubyid_family_member'>family_member</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="Family.html" title="Family (class)">Family</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Family.html#IMMEDIATE_FAMILY-constant" title="Family::IMMEDIATE_FAMILY (constant)">IMMEDIATE_FAMILY</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_family_member'>family_member</span><span class='period'>.</span><span class='id identifier rubyid_primary_relationship'>primary_relationship</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_immediate_family_coverage_household'>immediate_family_coverage_household</span><span class='period'>.</span><span class='id identifier rubyid_add_coverage_household_member'>add_coverage_household_member</span><span class='lparen'>(</span><span class='id identifier rubyid_family_member'>family_member</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_extended_family_coverage_household'>extended_family_coverage_household</span><span class='period'>.</span><span class='id identifier rubyid_remove_family_member'>remove_family_member</span><span class='lparen'>(</span><span class='id identifier rubyid_family_member'>family_member</span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_immediate_family_coverage_household'>immediate_family_coverage_household</span><span class='period'>.</span><span class='id identifier rubyid_remove_family_member'>remove_family_member</span><span class='lparen'>(</span><span class='id identifier rubyid_family_member'>family_member</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_extended_family_coverage_household'>extended_family_coverage_household</span><span class='period'>.</span><span class='id identifier rubyid_add_coverage_household_member'>add_coverage_household_member</span><span class='lparen'>(</span><span class='id identifier rubyid_family_member'>family_member</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="add_tax_household_family_member-instance_method">
  
    #<strong>add_tax_household_family_member</strong>(family_member, verified_tax_household_member)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


140
141
142
143
144
145
146
147
148</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 140</span>

<span class='kw'>def</span> <span class='id identifier rubyid_add_tax_household_family_member'>add_tax_household_family_member</span><span class='lparen'>(</span><span class='id identifier rubyid_family_member'>family_member</span><span class='comma'>,</span> <span class='id identifier rubyid_verified_tax_household_member'>verified_tax_household_member</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_th'>th</span> <span class='op'>=</span> <span class='id identifier rubyid_latest_active_tax_household'>latest_active_tax_household</span>
  <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_members'>tax_household_members</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span>
    <span class='label'>family_member:</span> <span class='id identifier rubyid_family_member'>family_member</span><span class='comma'>,</span>
    <span class='label'>is_subscriber:</span> <span class='kw'>false</span><span class='comma'>,</span>
    <span class='label'>is_ia_eligible:</span> <span class='id identifier rubyid_verified_tax_household_member'>verified_tax_household_member</span><span class='period'>.</span><span class='id identifier rubyid_is_insurance_assistance_eligible'>is_insurance_assistance_eligible</span>
  <span class='rparen'>)</span>
  <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="applicant_ids-instance_method">
  
    #<strong>applicant_ids</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


269
270
271
272
273
274
275
276
277
278
279
280</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 269</span>

<span class='kw'>def</span> <span class='id identifier rubyid_applicant_ids'>applicant_ids</span>
  <span class='id identifier rubyid_th_applicant_ids'>th_applicant_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_acc'>acc</span><span class='comma'>,</span> <span class='id identifier rubyid_th'>th</span><span class='op'>|</span>
    <span class='id identifier rubyid_acc'>acc</span> <span class='op'>+</span> <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_applicant_ids'>applicant_ids</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_ch_applicant_ids'>ch_applicant_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_coverage_households'>coverage_households</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_acc'>acc</span><span class='comma'>,</span> <span class='id identifier rubyid_ch'>ch</span><span class='op'>|</span>
    <span class='id identifier rubyid_acc'>acc</span> <span class='op'>+</span> <span class='id identifier rubyid_ch'>ch</span><span class='period'>.</span><span class='id identifier rubyid_applicant_ids'>applicant_ids</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_hbxe_applicant_ids'>hbxe_applicant_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_inject'>inject</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_acc'>acc</span><span class='comma'>,</span> <span class='id identifier rubyid_he'>he</span><span class='op'>|</span>
    <span class='id identifier rubyid_acc'>acc</span> <span class='op'>+</span> <span class='id identifier rubyid_he'>he</span><span class='period'>.</span><span class='id identifier rubyid_applicant_ids'>applicant_ids</span>
  <span class='kw'>end</span>
  <span class='lparen'>(</span><span class='id identifier rubyid_th_applicant_ids'>th_applicant_ids</span> <span class='op'>+</span> <span class='id identifier rubyid_ch_applicant_ids'>ch_applicant_ids</span> <span class='op'>+</span> <span class='id identifier rubyid_hbxe_applicant_ids'>hbxe_applicant_ids</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_distinct'>distinct</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build_or_update_tax_household_from_primary-instance_method">
  
    #<strong>build_or_update_tax_household_from_primary</strong>(verified_primary_family_member, primary_person, active_verified_household)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>def determination_split_coverage_household</p>

<pre class="code ruby"><code class="ruby"><span class='id identifier rubyid_hh'>hh</span> <span class='op'>=</span> <span class='id identifier rubyid_coverage_household'>coverage_household</span><span class='period'>.</span><span class='id identifier rubyid_find_or_initialize_by'>find_or_initialize_by</span><span class='lparen'>(</span><span class='label'>is_determination_split_household:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='id identifier rubyid_hh'>hh</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span> <span class='op'>||=</span> <span class='const'>DateTime</span><span class='period'>.</span><span class='id identifier rubyid_current'>current</span>
<span class='id identifier rubyid_hh'>hh</span>
</code></pre>

<p>end</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 83</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_or_update_tax_household_from_primary'>build_or_update_tax_household_from_primary</span><span class='lparen'>(</span><span class='id identifier rubyid_verified_primary_family_member'>verified_primary_family_member</span><span class='comma'>,</span> <span class='id identifier rubyid_primary_person'>primary_person</span><span class='comma'>,</span> <span class='id identifier rubyid_active_verified_household'>active_verified_household</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_verified_tax_household'>verified_tax_household</span> <span class='op'>=</span> <span class='id identifier rubyid_active_verified_household'>active_verified_household</span><span class='period'>.</span><span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_th'>th</span><span class='op'>|</span> <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>==</span> <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_primary_applicant_id'>primary_applicant_id</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_primary_applicant_id'>primary_applicant_id</span> <span class='op'>==</span> <span class='id identifier rubyid_verified_primary_family_member'>verified_primary_family_member</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>#</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_verified_tax_household'>verified_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_verified_tax_household'>verified_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_eligibility_determinations'>eligibility_determinations</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='id identifier rubyid_verified_primary_tax_household_member'>verified_primary_tax_household_member</span> <span class='op'>=</span> <span class='id identifier rubyid_verified_tax_household'>verified_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_members'>tax_household_members</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_thm'>thm</span><span class='op'>|</span> <span class='id identifier rubyid_thm'>thm</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>==</span> <span class='id identifier rubyid_verified_primary_family_member'>verified_primary_family_member</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_primary_family_member'>primary_family_member</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_family_members'>family_members</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span> <span class='id identifier rubyid_primary_person'>primary_person</span> <span class='op'>==</span> <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_person'>person</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
      <span class='id identifier rubyid_latest_tax_household'>latest_tax_household</span> <span class='op'>=</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>effective_ending_on:</span> <span class='kw'>nil</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
      <span class='id identifier rubyid_latest_tax_household'>latest_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes'>update_attributes</span><span class='lparen'>(</span><span class='label'>effective_ending_on:</span> <span class='id identifier rubyid_verified_tax_household'>verified_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_start_date'>start_date</span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_th'>th</span> <span class='op'>=</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span>
      <span class='label'>allocated_aptc:</span> <span class='id identifier rubyid_verified_tax_household'>verified_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_allocated_aptcs'>allocated_aptcs</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_total_amount'>total_amount</span><span class='comma'>,</span>
      <span class='label'>effective_starting_on:</span> <span class='id identifier rubyid_verified_tax_household'>verified_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_start_date'>start_date</span><span class='comma'>,</span>
      <span class='label'>is_eligibility_determined:</span> <span class='kw'>true</span><span class='comma'>,</span>
      <span class='label'>submitted_at:</span> <span class='id identifier rubyid_verified_tax_household'>verified_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span>
    <span class='rparen'>)</span>

    <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_members'>tax_household_members</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span>
      <span class='label'>family_member:</span> <span class='id identifier rubyid_primary_family_member'>primary_family_member</span><span class='comma'>,</span>
      <span class='label'>is_subscriber:</span> <span class='kw'>true</span><span class='comma'>,</span>
      <span class='label'>is_ia_eligible:</span> <span class='id identifier rubyid_verified_primary_tax_household_member'>verified_primary_tax_household_member</span><span class='period'>.</span><span class='id identifier rubyid_is_insurance_assistance_eligible'>is_insurance_assistance_eligible</span> <span class='op'>?</span> <span class='id identifier rubyid_verified_primary_tax_household_member'>verified_primary_tax_household_member</span><span class='period'>.</span><span class='id identifier rubyid_is_insurance_assistance_eligible'>is_insurance_assistance_eligible</span> <span class='op'>:</span> <span class='kw'>false</span>
    <span class='rparen'>)</span>

    <span class='comment'># verified_primary_family_member.financial_statements.each do |fs|
</span>    <span class='comment'>#   th.tax_household_members.first.financial_statements.build(
</span>    <span class='comment'>#     tax_filing_status: fs.tax_filing_status.split(&#39;#&#39;).last,
</span>    <span class='comment'>#     is_tax_filing_together: fs.is_tax_filing_together
</span>    <span class='comment'>#   )
</span>
    <span class='comment'>#   th.tax_household_members.first.financial_statements.last.incomes.each do |i|
</span>    <span class='comment'>#     th.tax_household_members.first.financial_statements.last.incomes.build(
</span>    <span class='comment'>#       amount:
</span>    <span class='comment'>#       end_date:
</span>    <span class='comment'>#       frequency:
</span>    <span class='comment'>#       start_date:
</span>    <span class='comment'>#       submitted_date:
</span>    <span class='comment'>#       type:
</span>    <span class='comment'>#     )
</span>    <span class='comment'>#   end
</span>    <span class='comment'># end
</span>
    <span class='id identifier rubyid_benchmark_plan_id'>benchmark_plan_id</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="HbxProfile.html" title="HbxProfile (class)">HbxProfile</a></span></span><span class='period'>.</span><span class='id identifier rubyid_current_hbx'><span class='object_link'><a href="HbxProfile.html#current_hbx-class_method" title="HbxProfile.current_hbx (method)">current_hbx</a></span></span><span class='period'>.</span><span class='id identifier rubyid_benefit_sponsorship'>benefit_sponsorship</span><span class='period'>.</span><span class='id identifier rubyid_current_benefit_coverage_period'>current_benefit_coverage_period</span><span class='period'>.</span><span class='id identifier rubyid_slcsp'>slcsp</span>

    <span class='id identifier rubyid_latest_eligibility_determination'>latest_eligibility_determination</span> <span class='op'>=</span> <span class='id identifier rubyid_verified_tax_household'>verified_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_eligibility_determinations'>eligibility_determinations</span><span class='period'>.</span><span class='id identifier rubyid_max_by'>max_by</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:determination_date</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_eligibility_determinations'>eligibility_determinations</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span>
      <span class='label'>e_pdc_id:</span> <span class='id identifier rubyid_latest_eligibility_determination'>latest_eligibility_determination</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span>
      <span class='label'>benchmark_plan_id:</span> <span class='id identifier rubyid_benchmark_plan_id'>benchmark_plan_id</span><span class='comma'>,</span>
      <span class='label'>max_aptc:</span> <span class='id identifier rubyid_latest_eligibility_determination'>latest_eligibility_determination</span><span class='period'>.</span><span class='id identifier rubyid_maximum_aptc'>maximum_aptc</span><span class='comma'>,</span>
      <span class='label'>csr_percent_as_integer:</span> <span class='id identifier rubyid_latest_eligibility_determination'>latest_eligibility_determination</span><span class='period'>.</span><span class='id identifier rubyid_csr_percent'>csr_percent</span><span class='comma'>,</span>
      <span class='label'>determined_on:</span> <span class='id identifier rubyid_latest_eligibility_determination'>latest_eligibility_determination</span><span class='period'>.</span><span class='id identifier rubyid_determination_date'>determination_date</span>
    <span class='rparen'>)</span>

    <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="build_thh_and_eligibility-instance_method">
  
    #<strong>build_thh_and_eligibility</strong>(max_aptc, csr, date, slcsp)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 230</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_thh_and_eligibility'>build_thh_and_eligibility</span><span class='lparen'>(</span><span class='id identifier rubyid_max_aptc'>max_aptc</span><span class='comma'>,</span> <span class='id identifier rubyid_csr'>csr</span><span class='comma'>,</span> <span class='id identifier rubyid_date'>date</span><span class='comma'>,</span> <span class='id identifier rubyid_slcsp'>slcsp</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_th'>th</span> <span class='op'>=</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span>
      <span class='label'>allocated_aptc:</span> <span class='float'>0.0</span><span class='comma'>,</span>
      <span class='label'>effective_starting_on:</span> <span class='const'>Date</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_date'>date</span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span><span class='comma'>,</span> <span class='id identifier rubyid_date'>date</span><span class='period'>.</span><span class='id identifier rubyid_month'>month</span><span class='comma'>,</span> <span class='id identifier rubyid_date'>date</span><span class='period'>.</span><span class='id identifier rubyid_day'>day</span><span class='rparen'>)</span><span class='comma'>,</span>
      <span class='label'>is_eligibility_determined:</span> <span class='kw'>true</span><span class='comma'>,</span>
      <span class='label'>submitted_at:</span> <span class='const'>Date</span><span class='period'>.</span><span class='id identifier rubyid_today'>today</span>
  <span class='rparen'>)</span>

  <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_members'>tax_household_members</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span>
      <span class='label'>family_member:</span> <span class='id identifier rubyid_family'>family</span><span class='period'>.</span><span class='id identifier rubyid_primary_family_member'>primary_family_member</span><span class='comma'>,</span>
      <span class='label'>is_subscriber:</span> <span class='kw'>true</span><span class='comma'>,</span>
      <span class='label'>is_ia_eligible:</span> <span class='kw'>true</span><span class='comma'>,</span>
  <span class='rparen'>)</span>

  <span class='id identifier rubyid_deter'>deter</span> <span class='op'>=</span> <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_eligibility_determinations'>eligibility_determinations</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span>
      <span class='label'>source:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Admin_Script</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
      <span class='label'>benchmark_plan_id:</span> <span class='id identifier rubyid_slcsp'>slcsp</span><span class='comma'>,</span>
      <span class='label'>max_aptc:</span> <span class='id identifier rubyid_max_aptc'>max_aptc</span><span class='period'>.</span><span class='id identifier rubyid_to_f'>to_f</span><span class='comma'>,</span>
      <span class='label'>csr_percent_as_integer:</span> <span class='id identifier rubyid_csr'>csr</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='comma'>,</span>
      <span class='label'>determined_on:</span> <span class='const'>Date</span><span class='period'>.</span><span class='id identifier rubyid_today'>today</span>
  <span class='rparen'>)</span>

  <span class='id identifier rubyid_deter'>deter</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>

  <span class='id identifier rubyid_end_multiple_thh'>end_multiple_thh</span>

  <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>

  <span class='id identifier rubyid_family'>family</span><span class='period'>.</span><span class='id identifier rubyid_active_dependents'>active_dependents</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_fm'>fm</span><span class='op'>|</span>
    <span class='id identifier rubyid_ath'>ath</span> <span class='op'>=</span> <span class='id identifier rubyid_latest_active_thh'>latest_active_thh</span>
    <span class='id identifier rubyid_ath'>ath</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_members'>tax_household_members</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span>
        <span class='label'>family_member:</span> <span class='id identifier rubyid_fm'>fm</span><span class='comma'>,</span>
        <span class='label'>is_subscriber:</span> <span class='kw'>false</span><span class='comma'>,</span>
        <span class='label'>is_ia_eligible:</span> <span class='kw'>true</span>
    <span class='rparen'>)</span>
    <span class='id identifier rubyid_ath'>ath</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_hbx_enrollment_from-instance_method">
  
    #<strong>create_hbx_enrollment_from</strong>(employee_role: nil, coverage_household: nil, benefit_group: nil, benefit_group_assignment: nil, consumer_role: nil, benefit_package: nil, submitted_at: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


335
336
337
338
339
340
341
342
343
344
345
346
347</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 335</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_hbx_enrollment_from'>create_hbx_enrollment_from</span><span class='lparen'>(</span><span class='label'>employee_role:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>coverage_household:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>benefit_group:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>benefit_group_assignment:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>consumer_role:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>benefit_package:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>submitted_at:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_enrollment'>enrollment</span> <span class='op'>=</span> <span class='id identifier rubyid_new_hbx_enrollment_from'>new_hbx_enrollment_from</span><span class='lparen'>(</span>
    <span class='label'>employee_role:</span> <span class='id identifier rubyid_employee_role'>employee_role</span><span class='comma'>,</span>
    <span class='label'>coverage_household:</span> <span class='id identifier rubyid_coverage_household'>coverage_household</span><span class='comma'>,</span>
    <span class='label'>benefit_group:</span> <span class='id identifier rubyid_benefit_group'>benefit_group</span><span class='comma'>,</span>
    <span class='label'>benefit_group_assignment:</span> <span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span><span class='comma'>,</span>
    <span class='label'>consumer_role:</span> <span class='id identifier rubyid_consumer_role'>consumer_role</span><span class='comma'>,</span>
    <span class='label'>benefit_package:</span> <span class='id identifier rubyid_benefit_package'>benefit_package</span><span class='comma'>,</span>
    <span class='label'>submitted_at:</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>
  <span class='rparen'>)</span>
  <span class='id identifier rubyid_enrollment'>enrollment</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
  <span class='id identifier rubyid_enrollment'>enrollment</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_hbx_enrollment-instance_method">
  
    #<strong>delete_hbx_enrollment</strong>(hbx_enrollment_id)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


349
350
351
352
353
354
355
356
357
358
359
360
361
362</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 349</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_hbx_enrollment'>delete_hbx_enrollment</span><span class='lparen'>(</span><span class='id identifier rubyid_hbx_enrollment_id'>hbx_enrollment_id</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span> <span class='op'>=</span> <span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span><span class='id identifier rubyid_hbx_enrollment_id'>hbx_enrollment_id</span><span class='rbrace'>}</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span> <span class='op'>=</span> <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
      <span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span><span class='period'>.</span><span class='id identifier rubyid_destroy!'>destroy!</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_destroy!'>destroy!</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_destroy!'>destroy!</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="effective_ending_on_gt_effective_starting_on-instance_method">
  
    #<strong>effective_ending_on_gt_effective_starting_on</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


150
151
152
153
154
155
156
157
158</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 150</span>

<span class='kw'>def</span> <span class='id identifier rubyid_effective_ending_on_gt_effective_starting_on'>effective_ending_on_gt_effective_starting_on</span>

  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_effective_ending_on'>effective_ending_on</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_effective_starting_on'>effective_starting_on</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_effective_ending_on'>effective_ending_on</span> <span class='op'>&lt;</span> <span class='id identifier rubyid_effective_starting_on'>effective_starting_on</span>
    <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:base</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>The effective end date should be earlier or equal to effective start date</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="eligibility_determinations_for_year-instance_method">
  
    #<strong>eligibility_determinations_for_year</strong>(year)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


394
395
396
397
398
399
400
401
402</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 394</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eligibility_determinations_for_year'>eligibility_determinations_for_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_eds'>eds</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_with_year'>tax_household_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_th'>th</span><span class='op'>|</span>
    <span class='id identifier rubyid_th'>th</span><span class='period'>.</span><span class='id identifier rubyid_eligibility_determinations'>eligibility_determinations</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ed'>ed</span><span class='op'>|</span>
      <span class='id identifier rubyid_eds'>eds</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_ed'>ed</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_eds'>eds</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="end_multiple_thh-instance_method">
  
    #<strong>end_multiple_thh</strong>(options = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


207
208
209
210
211
212
213
214
215</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 207</span>

<span class='kw'>def</span> <span class='id identifier rubyid_end_multiple_thh'>end_multiple_thh</span><span class='lparen'>(</span><span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_all_active_thh'>all_active_thh</span> <span class='op'>=</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_active_tax_household'>active_tax_household</span>
  <span class='id identifier rubyid_all_active_thh'>all_active_thh</span><span class='period'>.</span><span class='id identifier rubyid_group_by'>group_by</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:group_by_year</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_v'>v</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
    <span class='id identifier rubyid_sorted_ath'>sorted_ath</span> <span class='op'>=</span> <span class='id identifier rubyid_active_thh_with_year'>active_thh_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_order_by'>order_by</span><span class='lparen'>(</span><span class='symbol'>:created_at</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_asc'>asc</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_c'>c</span> <span class='op'>=</span> <span class='id identifier rubyid_sorted_ath'>sorted_ath</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>
    <span class='comment'>#for update eligibility manually
</span>    <span class='id identifier rubyid_sorted_ath'>sorted_ath</span><span class='period'>.</span><span class='id identifier rubyid_limit'>limit</span><span class='lparen'>(</span><span class='id identifier rubyid_c'>c</span><span class='op'>-</span><span class='int'>1</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_update_all'>update_all</span><span class='lparen'>(</span><span class='label'>effective_ending_on:</span> <span class='const'>Date</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='int'>12</span><span class='comma'>,</span> <span class='int'>31</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_sorted_ath'>sorted_ath</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="enrolled_hbx_enrollments-instance_method">
  
    #<strong>enrolled_hbx_enrollments</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


378
379
380</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 378</span>

<span class='kw'>def</span> <span class='id identifier rubyid_enrolled_hbx_enrollments'>enrolled_hbx_enrollments</span>
  <span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_enrolled'>enrolled</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="enrolled_including_waived_hbx_enrollments-instance_method">
  
    #<strong>enrolled_including_waived_hbx_enrollments</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


370
371
372
373
374
375
376</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 370</span>

<span class='kw'>def</span> <span class='id identifier rubyid_enrolled_including_waived_hbx_enrollments'>enrolled_including_waived_hbx_enrollments</span>
  <span class='comment'>#hbx_enrollments.coverage_selected_and_waived
</span>  <span class='id identifier rubyid_enrs'>enrs</span> <span class='op'>=</span> <span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_coverage_selected_and_waived'>coverage_selected_and_waived</span>
  <span class='id identifier rubyid_health_enr'>health_enr</span> <span class='op'>=</span> <span class='id identifier rubyid_enrs'>enrs</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_coverage_kind'>coverage_kind</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>health</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_dental_enr'>dental_enr</span> <span class='op'>=</span> <span class='id identifier rubyid_enrs'>enrs</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='period'>.</span><span class='id identifier rubyid_coverage_kind'>coverage_kind</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>dental</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
  <span class='lbracket'>[</span><span class='id identifier rubyid_health_enr'>health_enr</span> <span class='comma'>,</span> <span class='id identifier rubyid_dental_enr'>dental_enr</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_compact'>compact</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="extended_family_coverage_household-instance_method">
  
    #<strong>extended_family_coverage_household</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74
75</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_extended_family_coverage_household'>extended_family_coverage_household</span>
  <span class='id identifier rubyid_ch'>ch</span> <span class='op'>=</span> <span class='id identifier rubyid_coverage_households'>coverage_households</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_hh'>hh</span><span class='op'>|</span> <span class='op'>!</span><span class='id identifier rubyid_hh'>hh</span><span class='period'>.</span><span class='id identifier rubyid_is_immediate_family?'>is_immediate_family?</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_ch'>ch</span> <span class='op'>||=</span> <span class='id identifier rubyid_coverage_households'>coverage_households</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='label'>is_immediate_family:</span> <span class='kw'>false</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="hbx_enrollments_with_aptc_by_date-instance_method">
  
    #<strong>hbx_enrollments_with_aptc_by_date</strong>(date)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


386
387
388</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 386</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hbx_enrollments_with_aptc_by_date'>hbx_enrollments_with_aptc_by_date</span><span class='lparen'>(</span><span class='id identifier rubyid_date'>date</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_enrolled_and_renewing'>enrolled_and_renewing</span><span class='period'>.</span><span class='id identifier rubyid_with_aptc'>with_aptc</span><span class='period'>.</span><span class='id identifier rubyid_by_year'>by_year</span><span class='lparen'>(</span><span class='id identifier rubyid_date'>date</span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gte'>gte</span><span class='lparen'>(</span><span class='label'>effective_on:</span> <span class='id identifier rubyid_date'>date</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="hbx_enrollments_with_aptc_by_year-instance_method">
  
    #<strong>hbx_enrollments_with_aptc_by_year</strong>(year)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


390
391
392</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 390</span>

<span class='kw'>def</span> <span class='id identifier rubyid_hbx_enrollments_with_aptc_by_year'>hbx_enrollments_with_aptc_by_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_enrolled_and_renewing'>enrolled_and_renewing</span><span class='period'>.</span><span class='id identifier rubyid_with_aptc'>with_aptc</span><span class='period'>.</span><span class='id identifier rubyid_by_year'>by_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="immediate_family_coverage_household-instance_method">
  
    #<strong>immediate_family_coverage_household</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69
70</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 67</span>

<span class='kw'>def</span> <span class='id identifier rubyid_immediate_family_coverage_household'>immediate_family_coverage_household</span>
  <span class='id identifier rubyid_ch'>ch</span> <span class='op'>=</span> <span class='id identifier rubyid_coverage_households'>coverage_households</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_hh'>hh</span><span class='op'>|</span> <span class='id identifier rubyid_hh'>hh</span><span class='period'>.</span><span class='id identifier rubyid_is_immediate_family?'>is_immediate_family?</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_ch'>ch</span> <span class='op'>||=</span> <span class='id identifier rubyid_coverage_households'>coverage_households</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span><span class='lparen'>(</span><span class='label'>is_immediate_family:</span> <span class='kw'>true</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="irs_group-instance_method">
  
    #<strong>irs_group</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


171
172
173
174</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 171</span>

<span class='kw'>def</span> <span class='id identifier rubyid_irs_group'>irs_group</span>
  <span class='kw'>return</span> <span class='ivar'>@irs_group</span> <span class='kw'>if</span> <span class='kw'>defined?</span> <span class='ivar'>@irs_group</span>
  <span class='ivar'>@irs_group</span> <span class='op'>=</span> <span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_irs_groups'>irs_groups</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_irs_group_id'>irs_group_id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="irs_group=-instance_method">
  
    #<strong>irs_group=</strong>(new_irs_group)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167
168
169</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 165</span>

<span class='kw'>def</span> <span class='id identifier rubyid_irs_group='>irs_group=</span><span class='lparen'>(</span><span class='id identifier rubyid_new_irs_group'>new_irs_group</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_new_irs_group'>new_irs_group</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span> <span class='const'><span class='object_link'><a href="IrsGroup.html" title="IrsGroup (class)">IrsGroup</a></span></span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_irs_group_id'>irs_group_id</span> <span class='op'>=</span> <span class='id identifier rubyid_new_irs_group'>new_irs_group</span><span class='period'>.</span><span class='id identifier rubyid__id'>_id</span>
  <span class='ivar'>@irs_group</span> <span class='op'>=</span> <span class='id identifier rubyid_new_irs_group'>new_irs_group</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="is_active?-instance_method">
  
    #<strong>is_active?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 176</span>

<span class='kw'>def</span> <span class='id identifier rubyid_is_active?'>is_active?</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_active'>is_active</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="latest_active_tax_household-instance_method">
  
    #<strong>latest_active_tax_household</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


185
186
187
188</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 185</span>

<span class='kw'>def</span> <span class='id identifier rubyid_latest_active_tax_household'>latest_active_tax_household</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='kw'>if</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span>
  <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>effective_ending_on:</span> <span class='kw'>nil</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:effective_starting_on</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="latest_active_tax_household_with_year-instance_method">
  
    #<strong>latest_active_tax_household_with_year</strong>(year)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192
193
194
195
196
197
198
199
200
201</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_latest_active_tax_household_with_year'>latest_active_tax_household_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tax_households'>tax_households</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_with_year'>tax_household_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='const'><span class='object_link'><a href="TimeKeeper.html" title="TimeKeeper (class)">TimeKeeper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_date_of_record'><span class='object_link'><a href="TimeKeeper.html#date_of_record-class_method" title="TimeKeeper.date_of_record (method)">date_of_record</a></span></span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span> <span class='op'>==</span> <span class='id identifier rubyid_year'>year</span>
    <span class='id identifier rubyid_tax_households'>tax_households</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_with_year'>tax_household_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_active_tax_household'>active_tax_household</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>nil</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_entries'>entries</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="latest_active_thh-instance_method">
  
    #<strong>latest_active_thh</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


217
218
219
220</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 217</span>

<span class='kw'>def</span> <span class='id identifier rubyid_latest_active_thh'>latest_active_thh</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='kw'>if</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>==</span> <span class='int'>1</span>
  <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_active_tax_household'>active_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_order_by'>order_by</span><span class='lparen'>(</span><span class='symbol'>:created_at</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_desc'>desc</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="latest_active_thh_with_year-instance_method">
  
    #<strong>latest_active_thh_with_year</strong>(year)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


222
223
224</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 222</span>

<span class='kw'>def</span> <span class='id identifier rubyid_latest_active_thh_with_year'>latest_active_thh_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_with_year'>tax_household_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_active_tax_household'>active_tax_household</span><span class='period'>.</span><span class='id identifier rubyid_order_by'>order_by</span><span class='lparen'>(</span><span class='symbol'>:created_at</span><span class='tstring_end'>&#39;</span></span><span class='period'>.</span><span class='id identifier rubyid_desc'>desc</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="latest_coverage_household-instance_method">
  
    #<strong>latest_coverage_household</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182
183</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 180</span>

<span class='kw'>def</span> <span class='id identifier rubyid_latest_coverage_household'>latest_coverage_household</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_coverage_households'>coverage_households</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span> <span class='kw'>if</span> <span class='id identifier rubyid_coverage_households'>coverage_households</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
  <span class='id identifier rubyid_coverage_households'>coverage_households</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:submitted_at</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="latest_tax_household_with_year-instance_method">
  
    #<strong>latest_tax_household_with_year</strong>(year)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


203
204
205</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 203</span>

<span class='kw'>def</span> <span class='id identifier rubyid_latest_tax_household_with_year'>latest_tax_household_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_tax_household_with_year'>tax_household_with_year</span><span class='lparen'>(</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:last</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="new_hbx_enrollment_from-instance_method">
  
    #<strong>new_hbx_enrollment_from</strong>(employee_role: nil, coverage_household: nil, benefit_group: nil, benefit_group_assignment: nil, resident_role: nil, consumer_role: nil, benefit_package: nil, qle: false, submitted_at: nil, coverage_start: nil, enrollment_kind: nil, external_enrollment: false, opt_effective_on: nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 317</span>

<span class='kw'>def</span> <span class='id identifier rubyid_new_hbx_enrollment_from'>new_hbx_enrollment_from</span><span class='lparen'>(</span><span class='label'>employee_role:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>coverage_household:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>benefit_group:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>benefit_group_assignment:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>resident_role:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>consumer_role:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>benefit_package:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>qle:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>submitted_at:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>coverage_start:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>enrollment_kind:</span><span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>external_enrollment:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>opt_effective_on:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_coverage_household'>coverage_household</span> <span class='op'>=</span> <span class='id identifier rubyid_latest_coverage_household'>latest_coverage_household</span> <span class='kw'>unless</span> <span class='id identifier rubyid_coverage_household'>coverage_household</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
  <span class='const'><span class='object_link'><a href="HbxEnrollment.html" title="HbxEnrollment (class)">HbxEnrollment</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_from'><span class='object_link'><a href="HbxEnrollment.html#new_from-class_method" title="HbxEnrollment.new_from (method)">new_from</a></span></span><span class='lparen'>(</span>
    <span class='label'>employee_role:</span> <span class='id identifier rubyid_employee_role'>employee_role</span><span class='comma'>,</span>
    <span class='label'>resident_role:</span> <span class='id identifier rubyid_resident_role'>resident_role</span><span class='comma'>,</span>
    <span class='label'>coverage_household:</span> <span class='id identifier rubyid_coverage_household'>coverage_household</span><span class='comma'>,</span>
    <span class='label'>benefit_group:</span> <span class='id identifier rubyid_benefit_group'>benefit_group</span><span class='comma'>,</span>
    <span class='label'>benefit_group_assignment:</span> <span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span><span class='comma'>,</span>
    <span class='label'>consumer_role:</span> <span class='id identifier rubyid_consumer_role'>consumer_role</span><span class='comma'>,</span>
    <span class='label'>benefit_package:</span> <span class='id identifier rubyid_benefit_package'>benefit_package</span><span class='comma'>,</span>
    <span class='label'>qle:</span> <span class='id identifier rubyid_qle'>qle</span><span class='comma'>,</span>
    <span class='label'>submitted_at:</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='comma'>,</span>
    <span class='label'>external_enrollment:</span> <span class='id identifier rubyid_external_enrollment'>external_enrollment</span><span class='comma'>,</span>
    <span class='label'>coverage_start:</span> <span class='id identifier rubyid_coverage_start'>coverage_start</span><span class='comma'>,</span>
    <span class='label'>opt_effective_on:</span> <span class='id identifier rubyid_opt_effective_on'>opt_effective_on</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="parent-instance_method">
  
    #<strong>parent</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


160
161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 160</span>

<span class='kw'>def</span> <span class='id identifier rubyid_parent'>parent</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>undefined parent family</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_family'>family</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_family'>family</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="remove_family_member-instance_method">
  
    #<strong>remove_family_member</strong>(member)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


364
365
366
367
368</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 364</span>

<span class='kw'>def</span> <span class='id identifier rubyid_remove_family_member'>remove_family_member</span><span class='lparen'>(</span><span class='id identifier rubyid_member'>member</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_coverage_households'>coverage_households</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_c_household'>c_household</span><span class='op'>|</span>
    <span class='id identifier rubyid_c_household'>c_household</span><span class='period'>.</span><span class='id identifier rubyid_remove_family_member'>remove_family_member</span><span class='lparen'>(</span><span class='id identifier rubyid_member'>member</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="renewing_hbx_enrollments-instance_method">
  
    #<strong>renewing_hbx_enrollments</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


49
50
51</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 49</span>

<span class='kw'>def</span> <span class='id identifier rubyid_renewing_hbx_enrollments'>renewing_hbx_enrollments</span>
  <span class='id identifier rubyid_active_hbx_enrollments'>active_hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_en'>en</span><span class='op'>|</span> <span class='op'>!</span><span class='const'><span class='object_link'><a href="HbxEnrollment.html" title="HbxEnrollment (class)">HbxEnrollment</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="HbxEnrollment.html#RENEWAL_STATUSES-constant" title="HbxEnrollment::RENEWAL_STATUSES (constant)">RENEWAL_STATUSES</a></span></span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_enrollment'>enrollment</span><span class='period'>.</span><span class='id identifier rubyid_aasm_state'>aasm_state</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="renewing_individual_market_hbx_enrollments-instance_method">
  
    #<strong>renewing_individual_market_hbx_enrollments</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


53
54
55</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 53</span>

<span class='kw'>def</span> <span class='id identifier rubyid_renewing_individual_market_hbx_enrollments'>renewing_individual_market_hbx_enrollments</span>
  <span class='id identifier rubyid_renewing_hbx_enrollments'>renewing_hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_reject'>reject</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_en'>en</span><span class='op'>|</span> <span class='id identifier rubyid_en'>en</span><span class='period'>.</span><span class='id identifier rubyid_enrollment_kind'>enrollment_kind</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>individual</span><span class='tstring_end'>&#39;</span></span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="reset_is_active_for_previous-instance_method">
  
    #<strong>reset_is_active_for_previous</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


294
295
296
297
298
299
300</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 294</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reset_is_active_for_previous'>reset_is_active_for_previous</span>
  <span class='id identifier rubyid_latest_household'>latest_household</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_family'>family</span><span class='period'>.</span><span class='id identifier rubyid_latest_household'>latest_household</span>
  <span class='id identifier rubyid_active_value'>active_value</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_active'>is_active</span>
  <span class='id identifier rubyid_latest_household'>latest_household</span><span class='period'>.</span><span class='id identifier rubyid_is_active'>is_active</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_active'>is_active</span> <span class='op'>=</span> <span class='id identifier rubyid_active_value'>active_value</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_effective_ending_on-instance_method">
  
    #<strong>set_effective_ending_on</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>This will set the effective_ending_on of previously active household to 1
day before start of the current household&#39;s effective_starting_on</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


284
285
286
287
288
289
290
291
292</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 284</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_effective_ending_on'>set_effective_ending_on</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_effective_starting_on'>effective_starting_on</span>

  <span class='id identifier rubyid_latest_household'>latest_household</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_family'>family</span><span class='period'>.</span><span class='id identifier rubyid_latest_household'>latest_household</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='kw'>self</span> <span class='op'>==</span> <span class='id identifier rubyid_latest_household'>latest_household</span>

  <span class='id identifier rubyid_latest_household'>latest_household</span><span class='period'>.</span><span class='id identifier rubyid_effective_ending_on'>effective_ending_on</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_effective_starting_on'>effective_starting_on</span> <span class='op'>-</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_day'>day</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_effective_starting_on-instance_method">
  
    #<strong>set_effective_starting_on</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


310
311
312
313
314
315</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 310</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_effective_starting_on'>set_effective_starting_on</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_effective_starting_on'>effective_starting_on</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_effective_starting_on'>effective_starting_on</span> <span class='op'>=</span>  <span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_submitted_at-instance_method">
  
    #<strong>set_submitted_at</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


302
303
304
305
306
307
308</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/household.rb', line 302</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_submitted_at'>set_submitted_at</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>

  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span> <span class='op'>=</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_sort_by'>sort_by</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:updated_at</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_last'>last</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span> <span class='kw'>if</span> <span class='id identifier rubyid_tax_households'>tax_households</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
  <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span> <span class='op'>=</span> <span class='id identifier rubyid_parent'>parent</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span> <span class='kw'>unless</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_submitted_at'>submitted_at</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Oct 11 09:49:37 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.2.3).
</div>

    </div>
  </body>
</html>