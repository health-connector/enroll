<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: BrokerAgencies::QuotesController
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "BrokerAgencies::QuotesController";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (Q)</a> &raquo;
    <span class='title'>BrokerAgencies</span>
     &raquo; 
    <span class="title">QuotesController</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: BrokerAgencies::QuotesController
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">ApplicationController</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">ApplicationController</li>
          
            <li class="next">BrokerAgencies::QuotesController</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  <dl>
      <dt>Includes:</dt>
      <dd>QuoteHelper</dd>
  </dl>
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/controllers/broker_agencies/quotes_controller.rb</dd>
  </dl>
  
</div>








  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#build_employee_roster-instance_method" title="#build_employee_roster (instance method)">#<strong>build_employee_roster</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#copy-instance_method" title="#copy (instance method)">#<strong>copy</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create-instance_method" title="#create (instance method)">#<strong>create</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#criteria-instance_method" title="#criteria (instance method)">#<strong>criteria</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_benefit_group-instance_method" title="#delete_benefit_group (instance method)">#<strong>delete_benefit_group</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_household-instance_method" title="#delete_household (instance method)">#<strong>delete_household</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_member-instance_method" title="#delete_member (instance method)">#<strong>delete_member</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_quote-instance_method" title="#delete_quote (instance method)">#<strong>delete_quote</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete_quote_modal-instance_method" title="#delete_quote_modal (instance method)">#<strong>delete_quote_modal</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dental_cost_comparison-instance_method" title="#dental_cost_comparison (instance method)">#<strong>dental_cost_comparison</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dental_plans_data-instance_method" title="#dental_plans_data (instance method)">#<strong>dental_plans_data</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#download_employee_roster-instance_method" title="#download_employee_roster (instance method)">#<strong>download_employee_roster</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#download_pdf-instance_method" title="#download_pdf (instance method)">#<strong>download_pdf</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#edit-instance_method" title="#edit (instance method)">#<strong>edit</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>no longer use? def add_family   @qhh =
Quote.all.first.quote_households.first   @quote = Quote.find(@qhh.quote)  
respond_to do |format|     format.js   end end.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#employee_type-instance_method" title="#employee_type (instance method)">#<strong>employee_type</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#employees_list-instance_method" title="#employees_list (instance method)">#<strong>employees_list</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_quote_info-instance_method" title="#get_quote_info (instance method)">#<strong>get_quote_info</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#health_cost_comparison-instance_method" title="#health_cost_comparison (instance method)">#<strong>health_cost_comparison</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#my_quotes-instance_method" title="#my_quotes (instance method)">#<strong>my_quotes</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>displays index page of quotes.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new-instance_method" title="#new (instance method)">#<strong>new</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_household-instance_method" title="#new_household (instance method)">#<strong>new_household</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#plan_comparison-instance_method" title="#plan_comparison (instance method)">#<strong>plan_comparison</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#publish-instance_method" title="#publish (instance method)">#<strong>publish</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#publish_quote-instance_method" title="#publish_quote (instance method)">#<strong>publish_quote</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_plan-instance_method" title="#set_plan (instance method)">#<strong>set_plan</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#show-instance_method" title="#show (instance method)">#<strong>show</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update-instance_method" title="#update (instance method)">#<strong>update</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_benefits-instance_method" title="#update_benefits (instance method)">#<strong>update_benefits</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#upload_employee_roster-instance_method" title="#upload_employee_roster (instance method)">#<strong>upload_employee_roster</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#view_published_quote-instance_method" title="#view_published_quote (instance method)">#<strong>view_published_quote</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="build_employee_roster-instance_method">
  
    #<strong>build_employee_roster</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 227</span>

<span class='kw'>def</span> <span class='id identifier rubyid_build_employee_roster'>build_employee_roster</span>
  <span class='ivar'>@employee_roster</span> <span class='op'>=</span> <span class='id identifier rubyid_parse_employee_roster_file'>parse_employee_roster_file</span>
  <span class='ivar'>@quote</span><span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_broker_role_id'>broker_role_id</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_broker_role'>broker_role</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='ivar'>@orgs</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Organization.html" title="Organization (class)">Organization</a></span></span><span class='period'>.</span><span class='id identifier rubyid_by_broker_role'>by_broker_role</span><span class='lparen'>(</span><span class='id identifier rubyid_broker_role_id'>broker_role_id</span><span class='rparen'>)</span>
  <span class='ivar'>@employer_profiles</span> <span class='op'>=</span> <span class='ivar'>@orgs</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='rbrace'>}</span> <span class='kw'>unless</span> <span class='ivar'>@orgs</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
  <span class='ivar'>@quote_benefit_group_dropdown</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span>
  <span class='kw'>if</span> <span class='ivar'>@employee_roster</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span><span class='const'>Hash</span><span class='rparen'>)</span>
    <span class='ivar'>@employee_roster</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_family_id'>family_id</span> <span class='comma'>,</span> <span class='id identifier rubyid_members'>members</span><span class='op'>|</span>
      <span class='ivar'>@quote_household</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:family_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_family_id'>family_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
      <span class='ivar'>@quote_household</span><span class='op'>=</span> <span class='const'><span class='object_link'><a href="../QuoteHousehold.html" title="QuoteHousehold (class)">QuoteHousehold</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:family_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_family_id'>family_id</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='ivar'>@quote_household</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_members'>members</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_member'>member</span><span class='op'>|</span>
        <span class='ivar'>@quote_members</span><span class='op'>=</span> <span class='const'><span class='object_link'><a href="../QuoteMember.html" title="QuoteMember (class)">QuoteMember</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:employee_relationship</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_member'>member</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:dob</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_member'>member</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:last_name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_member'>member</span><span class='lbracket'>[</span><span class='int'>2</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:first_name</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_member'>member</span><span class='lbracket'>[</span><span class='int'>3</span><span class='rbracket'>]</span><span class='rparen'>)</span>
        <span class='ivar'>@quote_household</span><span class='period'>.</span><span class='id identifier rubyid_quote_members'>quote_members</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@quote_members</span>
      <span class='kw'>end</span>
      <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@quote_household</span>
      <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_save!'>save!</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_edit_broker_agencies_broker_role_quote_path'>edit_broker_agencies_broker_role_quote_path</span><span class='lparen'>(</span><span class='ivar'>@broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='ivar'>@quote</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="copy-instance_method">
  
    #<strong>copy</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


416
417
418
419</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 416</span>

<span class='kw'>def</span> <span class='id identifier rubyid_copy'>copy</span>
  <span class='ivar'>@q</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_clone'>clone</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create-instance_method">
  
    #<strong>create</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195
196
197
198
199
200
201
202
203
204
205
206</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 193</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create'>create</span>
  <span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_quote_params'>quote_params</span><span class='rparen'>)</span>
  <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_broker_role_id'>broker_role_id</span><span class='op'>=</span> <span class='ivar'>@broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='kw'>if</span> <span class='ivar'>@format_errors</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:error</span><span class='rbracket'>]</span><span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@format_errors</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>, </span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_render'>render</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>new</span><span class='tstring_end'>&quot;</span></span>  <span class='kw'>and</span> <span class='kw'>return</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
    <span class='id identifier rubyid_redirect_to'>redirect_to</span>  <span class='id identifier rubyid_edit_broker_agencies_broker_role_quote_path'>edit_broker_agencies_broker_role_quote_path</span><span class='lparen'>(</span><span class='ivar'>@broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='ivar'>@quote</span><span class='rparen'>)</span><span class='comma'>,</span><span class='symbol'>:flash</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:notice</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Successfully saved quote/employee roster.</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:error</span><span class='rbracket'>]</span><span class='op'>=</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to save the employee roster : </span><span class='embexpr_beg'>#{</span><span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_full_messages'>full_messages</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>, </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_render'>render</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>new</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="criteria-instance_method">
  
    #<strong>criteria</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


433
434
435
436
437
438
439
440
441</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 433</span>

<span class='kw'>def</span> <span class='id identifier rubyid_criteria'>criteria</span>
  <span class='id identifier rubyid_benefit_group'>benefit_group</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_benefit_group'>benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_is_complete?'>is_complete?</span>
  <span class='id identifier rubyid_criteria_for_ui'>criteria_for_ui</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:criteria_for_ui</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_deductible_for_ui'>deductible_for_ui</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:deductible_for_ui</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_benefit_group'>benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes!'>update_attributes!</span><span class='lparen'>(</span><span class='label'>criteria_for_ui:</span> <span class='id identifier rubyid_criteria_for_ui'>criteria_for_ui</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_criteria_for_ui'>criteria_for_ui</span>
  <span class='id identifier rubyid_benefit_group'>benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes'>update_attributes</span><span class='lparen'>(</span><span class='label'>deductible_for_ui:</span> <span class='id identifier rubyid_deductible_for_ui'>deductible_for_ui</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_deductible_for_ui'>deductible_for_ui</span>
  <span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_benefit_group'>benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_criteria_for_ui'>criteria_for_ui</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_benefit_group-instance_method">
  
    #<strong>delete_benefit_group</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


309
310
311
312
313
314
315
316
317
318
319
320
321
322
323</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 309</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_benefit_group'>delete_benefit_group</span>

  <span class='id identifier rubyid_quote_benefit_group'>quote_benefit_group</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../QuoteBenefitGroup.html" title="QuoteBenefitGroup (class)">QuoteBenefitGroup</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'><span class='object_link'><a href="../QuoteBenefitGroup.html#find-class_method" title="QuoteBenefitGroup.find (method)">find</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_benefit_group_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_quote_benefit_group'>quote_benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_is_assigned?'>is_assigned?</span>
    <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:text</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>false</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:format</span> <span class='op'>=&gt;</span> <span class='symbol'>:js</span>
    <span class='kw'>return</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_quote_benefit_group'>quote_benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
      <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:nothing</span> <span class='op'>=&gt;</span> <span class='kw'>true</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_household-instance_method">
  
    #<strong>delete_household</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


299
300
301
302
303
304
305
306
307</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 299</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_household'>delete_household</span>
  <span class='comment'>#render :text =&gt; &quot;false&quot;, :format =&gt; :js if @quote.is_complete?
</span>  <span class='ivar'>@qh</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:household_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@qh</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
    <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
      <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:nothing</span> <span class='op'>=&gt;</span> <span class='kw'>true</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_member-instance_method">
  
    #<strong>delete_member</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


284
285
286
287
288
289
290
291
292
293
294
295
296
297</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 284</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_member'>delete_member</span>
  <span class='kw'>if</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_is_complete?'>is_complete?</span>
    <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:text</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>false</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='symbol'>:format</span> <span class='op'>=&gt;</span> <span class='symbol'>:js</span>
    <span class='kw'>return</span>
  <span class='kw'>end</span>
  <span class='ivar'>@qh</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:household_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@qh</span>
    <span class='kw'>if</span> <span class='ivar'>@qh</span><span class='period'>.</span><span class='id identifier rubyid_quote_members'>quote_members</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:member_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span>
      <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
        <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:nothing</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='rbrace'>}</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_quote-instance_method">
  
    #<strong>delete_quote</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


272
273
274
275
276
277
278
279
280
281
282</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 272</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_quote'>delete_quote</span>
  <span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_destroy'>destroy</span>
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Successfully deleted </span><span class='embexpr_beg'>#{</span><span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_name'>quote_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
      <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span>
        <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_my_quotes_broker_agencies_broker_role_quotes_path'>my_quotes_broker_agencies_broker_role_quotes_path</span><span class='lparen'>(</span><span class='ivar'>@broker</span><span class='rparen'>)</span>
      <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete_quote_modal-instance_method">
  
    #<strong>delete_quote_modal</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


262
263
264
265
266
267
268
269
270</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 262</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete_quote_modal'>delete_quote_modal</span>
  <span class='ivar'>@row</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:row</span><span class='rbracket'>]</span>
  <span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span> <span class='lbrace'>{</span>
      <span class='id identifier rubyid_render'>render</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>datatables/delete_quote_modal</span><span class='tstring_end'>&quot;</span></span>
    <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dental_cost_comparison-instance_method">
  
    #<strong>dental_cost_comparison</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80
81</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 78</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dental_cost_comparison'>dental_cost_comparison</span>
  <span class='id identifier rubyid_get_dental_cost_comparison'>get_dental_cost_comparison</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>quote_id:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>benefit_id:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>plan_ids:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>plans</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_render'>render</span> <span class='label'>partial:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dental_cost_comparison</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>layout:</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="dental_plans_data-instance_method">
  
    #<strong>dental_plans_data</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


452
453
454
455</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 452</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dental_plans_data'>dental_plans_data</span>
  <span class='id identifier rubyid_set_dental_plans'>set_dental_plans</span>
  <span class='id identifier rubyid_render'>render</span> <span class='label'>partial:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>my_dental_plans</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="download_employee_roster-instance_method">
  
    #<strong>download_employee_roster</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


255
256
257
258
259
260</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 255</span>

<span class='kw'>def</span> <span class='id identifier rubyid_download_employee_roster'>download_employee_roster</span>
  <span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@employee_roster</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:quote_members</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
  <span class='id identifier rubyid_send_data'>send_data</span><span class='lparen'>(</span><span class='id identifier rubyid_csv_for'>csv_for</span><span class='lparen'>(</span><span class='ivar'>@employee_roster</span><span class='rparen'>)</span><span class='comma'>,</span> <span class='symbol'>:type</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>text/csv; charset=iso-8859-1; header=present</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='symbol'>:disposition</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>attachment; filename=Employee_Roster.csv</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="download_pdf-instance_method">
  
    #<strong>download_pdf</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


443
444
445
446
447
448
449
450</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 443</span>

<span class='kw'>def</span> <span class='id identifier rubyid_download_pdf'>download_pdf</span>
  <span class='id identifier rubyid_standard_component_ids'>standard_component_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_get_standard_component_ids'>get_standard_component_ids</span>
  <span class='ivar'>@qhps</span> <span class='op'>=</span> <span class='const'>Products</span><span class='op'>::</span><span class='const'>QhpCostShareVariance</span><span class='period'>.</span><span class='id identifier rubyid_find_qhp_cost_share_variances'>find_qhp_cost_share_variances</span><span class='lparen'>(</span><span class='id identifier rubyid_standard_component_ids'>standard_component_ids</span><span class='comma'>,</span> <span class='ivar'>@active_year</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Health</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_render'>render</span> <span class='label'>pdf:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>plan_comparison_export</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
         <span class='label'>template:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>broker_agencies/quotes/_plan_comparison_export.html.erb</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
         <span class='label'>disposition:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>attachment</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
         <span class='label'>locals:</span> <span class='lbrace'>{</span> <span class='label'>qhps:</span> <span class='ivar'>@qhps</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="edit-instance_method">
  
    #<strong>edit</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>no longer use? def add_family</p>

<pre class="code ruby"><code class="ruby"><span class='ivar'>@qhh</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='ivar'>@qhh</span><span class='period'>.</span><span class='id identifier rubyid_quote'>quote</span><span class='rparen'>)</span>
<span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
  <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span>
<span class='kw'>end</span>
</code></pre>

<p>end</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 92</span>

<span class='kw'>def</span> <span class='id identifier rubyid_edit'>edit</span>
  <span class='comment'>#find quote to edit
</span>  <span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_broker_role_id'>broker_role_id</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_broker_role'>broker_role</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='ivar'>@orgs</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Organization.html" title="Organization (class)">Organization</a></span></span><span class='period'>.</span><span class='id identifier rubyid_by_broker_role'>by_broker_role</span><span class='lparen'>(</span><span class='id identifier rubyid_broker_role_id'>broker_role_id</span><span class='rparen'>)</span>
  <span class='ivar'>@employer_profiles</span> <span class='op'>=</span>  <span class='ivar'>@orgs</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='op'>?</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='ivar'>@orgs</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_legal_name'>legal_name</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_max_family_id'>max_family_id</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='symbol'>:family_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:duplicate_household</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:num_of_dup</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='id identifier rubyid_dup_household'>dup_household</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:duplicate_household</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>

    <span class='kw'>for</span> <span class='id identifier rubyid_i'>i</span> <span class='kw'>in</span> <span class='int'>1</span><span class='op'>..</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:num_of_dup</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
      <span class='id identifier rubyid_temp_household'>temp_household</span> <span class='op'>=</span> <span class='id identifier rubyid_dup_household'>dup_household</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
      <span class='id identifier rubyid_max_family_id'>max_family_id</span> <span class='op'>=</span> <span class='id identifier rubyid_max_family_id'>max_family_id</span> <span class='op'>+</span> <span class='int'>1</span>
      <span class='id identifier rubyid_temp_household'>temp_household</span><span class='period'>.</span><span class='id identifier rubyid_family_id'>family_id</span> <span class='op'>=</span> <span class='id identifier rubyid_max_family_id'>max_family_id</span>
      <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_temp_household'>temp_household</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Create place holder for a new benefit group
</span>  <span class='id identifier rubyid_qbg'>qbg</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../QuoteBenefitGroup.html" title="QuoteBenefitGroup (class)">QuoteBenefitGroup</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='comment'># Create place holder for a new household and new member for the roster
</span>  <span class='id identifier rubyid_qhh'>qhh</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../QuoteHousehold.html" title="QuoteHousehold (class)">QuoteHousehold</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

  <span class='comment'># Increment family id so the new place holder contains max + 1
</span>  <span class='id identifier rubyid_qhh'>qhh</span><span class='period'>.</span><span class='id identifier rubyid_family_id'>family_id</span> <span class='op'>=</span> <span class='id identifier rubyid_max_family_id'>max_family_id</span> <span class='op'>+</span> <span class='int'>1</span>
  <span class='comment'># Create place holder for new member of household
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:new_family</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='id identifier rubyid_qm'>qm</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../QuoteMember.html" title="QuoteMember (class)">QuoteMember</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_qhh'>qhh</span><span class='period'>.</span><span class='id identifier rubyid_quote_members'>quote_members</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_qm'>qm</span>
    <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_qhh'>qhh</span>
  <span class='kw'>end</span>
  <span class='ivar'>@quote_benefit_group_dropdown</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_qbg'>qbg</span>


  <span class='ivar'>@scrollTo</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:scrollTo</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>1</span><span class='tstring_end'>&quot;</span></span> <span class='op'>?</span> <span class='int'>1</span> <span class='op'>:</span> <span class='int'>0</span>

  <span class='id identifier rubyid_flash'>flash</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This quote has been published and no editing is allowed.</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_is_complete?'>is_complete?</span>
  <span class='comment'>#redirect_to edit_broker_agencies_quote_path(@quote.id)
</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="employee_type-instance_method">
  
    #<strong>employee_type</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


486
487
488
489
490
491
492
493
494
495</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 486</span>

<span class='kw'>def</span> <span class='id identifier rubyid_employee_type'>employee_type</span>
  <span class='ivar'>@quote</span><span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_broker_role_id'>broker_role_id</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_broker_role'>broker_role</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='ivar'>@orgs</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Organization.html" title="Organization (class)">Organization</a></span></span><span class='period'>.</span><span class='id identifier rubyid_by_broker_role'>by_broker_role</span><span class='lparen'>(</span><span class='id identifier rubyid_broker_role_id'>broker_role_id</span><span class='rparen'>)</span>
  <span class='ivar'>@employer_profiles</span> <span class='op'>=</span>  <span class='ivar'>@orgs</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span> <span class='op'>?</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='ivar'>@orgs</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_o'>o</span><span class='op'>|</span> <span class='id identifier rubyid_o'>o</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_collect'>collect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_e'>e</span><span class='op'>|</span> <span class='lbracket'>[</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_legal_name'>legal_name</span><span class='comma'>,</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='ivar'>@employee_type</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_employer_type'>employer_type</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>client</span><span class='tstring_end'>&#39;</span></span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prospect</span><span class='tstring_end'>&#39;</span></span>
    <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_destroy_all'>destroy_all</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="employees_list-instance_method">
  
    #<strong>employees_list</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 457</span>

<span class='kw'>def</span> <span class='id identifier rubyid_employees_list'>employees_list</span>
 
  <span class='id identifier rubyid_employer_profile'>employer_profile</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../EmployerProfile.html" title="EmployerProfile (class)">EmployerProfile</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'><span class='object_link'><a href="../EmployerProfile.html#find-class_method" title="EmployerProfile.find (method)">find</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:employer_profile_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_quote'>quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@quote_benefit_group_dropdown</span> <span class='op'>=</span> <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span>

  <span class='kw'>unless</span> <span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='ivar'>@employees</span> <span class='op'>=</span> <span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_census_employees'>census_employees</span><span class='period'>.</span><span class='id identifier rubyid_non_terminated'>non_terminated</span>

    <span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='comment'># # Create place holder for new member of household
</span>    <span class='id identifier rubyid_households'>households</span> <span class='op'>=</span> <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_destroy_all'>destroy_all</span>
    <span class='ivar'>@employees</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_x'>x</span><span class='op'>|</span>
     <span class='id identifier rubyid_max_family_id'>max_family_id</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_max'>max</span><span class='lparen'>(</span><span class='symbol'>:family_id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
     <span class='id identifier rubyid_qhh'>qhh</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../QuoteHousehold.html" title="QuoteHousehold (class)">QuoteHousehold</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>family_id:</span> <span class='id identifier rubyid_max_family_id'>max_family_id</span> <span class='op'>+</span> <span class='int'>1</span><span class='rparen'>)</span>
     <span class='id identifier rubyid_qhh'>qhh</span><span class='period'>.</span><span class='id identifier rubyid_quote_members'>quote_members</span> <span class='op'>&lt;&lt;</span> <span class='const'><span class='object_link'><a href="../QuoteMember.html" title="QuoteMember (class)">QuoteMember</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='label'>dob:</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_dob'>dob</span><span class='comma'>,</span> <span class='label'>first_name:</span> <span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_first_name'>first_name</span><span class='comma'>,</span> <span class='label'>last_name:</span><span class='id identifier rubyid_x'>x</span><span class='period'>.</span><span class='id identifier rubyid_last_name'>last_name</span><span class='rparen'>)</span>
     <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_qhh'>qhh</span>
    <span class='kw'>end</span>
     <span class='ivar'>@employee_present</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_tmp_households'>tmp_households</span>
    <span class='ivar'>@employee_present</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='comment'># format.html 
</span>    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span>
  <span class='kw'>end</span>  
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_quote_info-instance_method">
  
    #<strong>get_quote_info</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 339</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_quote_info'>get_quote_info</span>
  <span class='id identifier rubyid_bp_hash'>bp_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_bp_dental_hash'>bp_dental_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_quote'>quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_benefit_groups'>benefit_groups</span> <span class='op'>=</span> <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span>
  <span class='id identifier rubyid_bg'>bg</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_group_id</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_group_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='id identifier rubyid_benefit_groups'>benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='id identifier rubyid_summary'>summary</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='label'>name:</span> <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_name'>quote_name</span><span class='comma'>,</span>
   <span class='label'>status:</span> <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_aasm_state'>aasm_state</span><span class='period'>.</span><span class='id identifier rubyid_capitalize'>capitalize</span><span class='comma'>,</span>
   <span class='label'>plan_name:</span> <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_plan'>plan</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>None</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
   <span class='label'>dental_plan_name:</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>bg.dental_plan &amp;&amp; bg.dental_plan.name</span><span class='tstring_end'>&quot;</span></span> <span class='op'>||</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>None</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>
  <span class='rbrace'>}</span>
  <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_quote_relationship_benefits'>quote_relationship_benefits</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_bp'>bp</span><span class='op'>|</span> <span class='id identifier rubyid_bp_hash'>bp_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_bp'>bp</span><span class='period'>.</span><span class='id identifier rubyid_relationship'>relationship</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_bp'>bp</span><span class='period'>.</span><span class='id identifier rubyid_premium_pct'>premium_pct</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_quote_dental_relationship_benefits'>quote_dental_relationship_benefits</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_bp'>bp</span><span class='op'>|</span> <span class='id identifier rubyid_bp_dental_hash'>bp_dental_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_bp'>bp</span><span class='period'>.</span><span class='id identifier rubyid_relationship'>relationship</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_bp'>bp</span><span class='period'>.</span><span class='id identifier rubyid_premium_pct'>premium_pct</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>relationship_benefits</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_bp_hash'>bp_hash</span><span class='comma'>,</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dental_relationship_benefits</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_bp_dental_hash'>bp_dental_hash</span><span class='comma'>,</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>roster_premiums</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_roster_cost_all_plans'>roster_cost_all_plans</span><span class='comma'>,</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dental_roster_premiums</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_roster_cost_all_plans'>roster_cost_all_plans</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dental</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='comma'>,</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>criteria</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_criteria_for_ui'>criteria_for_ui</span><span class='rparen'>)</span><span class='comma'>,</span>
                <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>summary</span><span class='tstring_end'>&#39;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_summary'>summary</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="health_cost_comparison-instance_method">
  
    #<strong>health_cost_comparison</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


73
74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 73</span>

<span class='kw'>def</span> <span class='id identifier rubyid_health_cost_comparison'>health_cost_comparison</span>
  <span class='id identifier rubyid_get_health_cost_comparison'>get_health_cost_comparison</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>quote_id:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>benefit_id:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_id</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>plan_ids:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>plans</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_render'>render</span> <span class='label'>partial:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>health_cost_comparison</span><span class='tstring_end'>&#39;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="my_quotes-instance_method">
  
    #<strong>my_quotes</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>displays index page of quotes</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


27
28
29
30
31
32
33
34
35</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 27</span>

<span class='kw'>def</span> <span class='id identifier rubyid_my_quotes'>my_quotes</span>
  <span class='ivar'>@all_quotes</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>broker_role_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='ivar'>@broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../Effective.html" title="Effective (module)">Effective</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Effective/Datatables.html" title="Effective::Datatables (module)">Datatables</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Effective/Datatables/QuoteDatatable.html" title="Effective::Datatables::QuoteDatatable (class)">QuoteDatatable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_broker_role_id'><span class='object_link'><a href="../Effective/Datatables/QuoteDatatable.html#broker_role_id-class_method" title="Effective::Datatables::QuoteDatatable.broker_role_id (method)">broker_role_id</a></span></span> <span class='op'>=</span> <span class='ivar'>@broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='ivar'>@datatable</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Effective.html" title="Effective (module)">Effective</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Effective/Datatables.html" title="Effective::Datatables (module)">Datatables</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Effective/Datatables/QuoteDatatable.html" title="Effective::Datatables::QuoteDatatable (class)">QuoteDatatable</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span><span class='id identifier rubyid_render'>render</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>quotes</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="new-instance_method">
  
    #<strong>new</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


136
137
138
139
140
141
142
143
144
145
146
147</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 136</span>

<span class='kw'>def</span> <span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_quote'>quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='comment'># Build Default Quote Benefit Group
</span>  <span class='id identifier rubyid_qbg'>qbg</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../QuoteBenefitGroup.html" title="QuoteBenefitGroup (class)">QuoteBenefitGroup</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_qbg'>qbg</span><span class='period'>.</span><span class='id identifier rubyid_title'>title</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Default Benefit Package</span><span class='tstring_end'>&quot;</span></span>
  <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_qbg'>qbg</span>
  <span class='comment'># Assign new quote to current broker
</span>  <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_broker_role_id'>broker_role_id</span><span class='op'>=</span> <span class='ivar'>@broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>

  <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span><span class='label'>validate:</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_edit_broker_agencies_broker_role_quote_path'>edit_broker_agencies_broker_role_quote_path</span><span class='lparen'>(</span><span class='ivar'>@broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="new_household-instance_method">
  
    #<strong>new_household</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


325
326
327
328</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 325</span>

<span class='kw'>def</span> <span class='id identifier rubyid_new_household'>new_household</span>
  <span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_build'>build</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="plan_comparison-instance_method">
  
    #<strong>plan_comparison</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 208</span>

<span class='kw'>def</span> <span class='id identifier rubyid_plan_comparison'>plan_comparison</span>
  <span class='id identifier rubyid_standard_component_ids'>standard_component_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_get_standard_component_ids'>get_standard_component_ids</span>
  <span class='ivar'>@qhps</span> <span class='op'>=</span> <span class='const'>Products</span><span class='op'>::</span><span class='const'>QhpCostShareVariance</span><span class='period'>.</span><span class='id identifier rubyid_find_qhp_cost_share_variances'>find_qhp_cost_share_variances</span><span class='lparen'>(</span><span class='id identifier rubyid_standard_component_ids'>standard_component_ids</span><span class='comma'>,</span> <span class='ivar'>@active_year</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Health</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@sort_by</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:sort_by</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_rstrip'>rstrip</span>
  <span class='comment'># Sorting by the same parameter alternates between ascending and descending
</span>  <span class='ivar'>@order</span> <span class='op'>=</span> <span class='ivar'>@sort_by</span> <span class='op'>==</span> <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:sort_by_copay</span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='op'>-</span><span class='int'>1</span> <span class='op'>:</span> <span class='int'>1</span>
  <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:sort_by_copay</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@order</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>?</span> <span class='ivar'>@sort_by</span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>if</span> <span class='ivar'>@sort_by</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@sort_by</span><span class='period'>.</span><span class='id identifier rubyid_length'>length</span> <span class='op'>&gt;</span> <span class='int'>0</span>
    <span class='ivar'>@sort_by</span> <span class='op'>=</span> <span class='ivar'>@sort_by</span><span class='period'>.</span><span class='id identifier rubyid_strip'>strip</span>
    <span class='id identifier rubyid_sort_array'>sort_array</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@qhps</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_qhp'>qhp</span><span class='op'>|</span>
      <span class='id identifier rubyid_sort_array'>sort_array</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span> <span class='lbracket'>[</span><span class='id identifier rubyid_qhp'>qhp</span><span class='comma'>,</span> <span class='id identifier rubyid_get_visit_cost'>get_visit_cost</span><span class='lparen'>(</span><span class='id identifier rubyid_qhp'>qhp</span><span class='comma'>,</span><span class='ivar'>@sort_by</span><span class='rparen'>)</span><span class='rbracket'>]</span>  <span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_sort_array'>sort_array</span><span class='period'>.</span><span class='id identifier rubyid_sort!'>sort!</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_a'>a</span><span class='comma'>,</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_a'>a</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='op'>*</span><span class='ivar'>@order</span> <span class='op'>&lt;=&gt;</span> <span class='id identifier rubyid_b'>b</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='op'>*</span><span class='ivar'>@order</span><span class='rbrace'>}</span>
    <span class='ivar'>@qhps</span> <span class='op'>=</span> <span class='id identifier rubyid_sort_array'>sort_array</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_item'>item</span><span class='op'>|</span> <span class='id identifier rubyid_item'>item</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='id identifier rubyid_render'>render</span> <span class='label'>partial:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>plan_comparision</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='label'>layout:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>locals:</span> <span class='lbrace'>{</span><span class='label'>qhps:</span> <span class='ivar'>@qhps</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="publish-instance_method">
  
    #<strong>publish</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


421
422
423
424
425
426
427
428
429
430
431</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 421</span>

<span class='kw'>def</span> <span class='id identifier rubyid_publish'>publish</span>
  <span class='ivar'>@q</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@benefit_groups</span> <span class='op'>=</span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span><span class='id identifier rubyid_render'>render</span> <span class='label'>partial:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>publish</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_pdf'>pdf</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:pdf</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>publised_quote</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
               <span class='symbol'>:template</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/broker_agencies/quotes/_publish.pdf.erb</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="publish_quote-instance_method">
  
    #<strong>publish_quote</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


15
16
17
18
19
20
21
22
23
24</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 15</span>

<span class='kw'>def</span> <span class='id identifier rubyid_publish_quote'>publish_quote</span>
  <span class='kw'>if</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_may_publish?'>may_publish?</span>
    <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_publish!'>publish!</span>
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:notice</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Quote Published</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_errors'>errors</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_warnings'>quote_warnings</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span>
    <span class='id identifier rubyid_flash'>flash</span><span class='lbracket'>[</span><span class='symbol'>:error</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Quote failed to publish. </span><span class='embexpr_beg'>#{</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;li&gt;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;/li&gt;&lt;li&gt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>&lt;/li&gt;</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:any?</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='period'>.</span><span class='id identifier rubyid_html_safe'>html_safe</span>
    <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_broker_agencies_broker_role_quote_path'>broker_agencies_broker_role_quote_path</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:broker_role_id</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_plan-instance_method">
  
    #<strong>set_plan</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 361</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_plan'>set_plan</span>
  <span class='ivar'>@q</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_bg'>bg</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_group_id</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_group_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:plan_id</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_bg'>bg</span>
    <span class='id identifier rubyid_plan'>plan</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plan.html" title="Plan (class)">Plan</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:plan_id</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='int'>8</span><span class='comma'>,</span><span class='int'>100</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:coverage_kind</span><span class='rbracket'>]</span>  <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dental</span><span class='tstring_end'>&#39;</span></span>
      <span class='id identifier rubyid_elected_plan_choice'>elected_plan_choice</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>na</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Single Plan</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Single Carrier</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Metal Level</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:elected</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_plan'>plan</span> <span class='op'>=</span> <span class='id identifier rubyid_plan'>plan</span>
      <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_plan_option_kind'>plan_option_kind</span> <span class='op'>=</span> <span class='id identifier rubyid_elected_plan_choice'>elected_plan_choice</span>
      <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_elected_health_plan_ids'>elected_health_plan_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:elected_plans_list</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_roster_elected_plan_bounds'>roster_elected_plan_bounds</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../PlanCostDecoratorQuote.html" title="PlanCostDecoratorQuote (class)">PlanCostDecoratorQuote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_elected_plans_cost_bounds'><span class='object_link'><a href="../PlanCostDecoratorQuote.html#elected_plans_cost_bounds-class_method" title="PlanCostDecoratorQuote.elected_plans_cost_bounds (method)">elected_plans_cost_bounds</a></span></span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../Plan.html" title="Plan (class)">Plan</a></span></span><span class='period'>.</span><span class='id identifier rubyid_shop_health_plans'><span class='object_link'><a href="../Plan.html#shop_health_plans-class_method" title="Plan.shop_health_plans (method)">shop_health_plans</a></span></span><span class='lparen'>(</span><span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_plan_year'>plan_year</span><span class='rparen'>)</span><span class='comma'>,</span>
         <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_quote_relationship_benefits'>quote_relationship_benefits</span><span class='comma'>,</span> <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_roster_cost_all_plans'>roster_cost_all_plans</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>health</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span>
      <span class='kw'>case</span> <span class='id identifier rubyid_elected_plan_choice'>elected_plan_choice</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Single Carrier</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_plan_option_kind'>plan_option_kind</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>single_carrier</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_published_lowest_cost_plan'>published_lowest_cost_plan</span> <span class='op'>=</span> <span class='id identifier rubyid_roster_elected_plan_bounds'>roster_elected_plan_bounds</span><span class='lbracket'>[</span><span class='symbol'>:carrier_low_plan</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_carrier_profile'>carrier_profile</span><span class='period'>.</span><span class='id identifier rubyid_abbrev'>abbrev</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_published_highest_cost_plan'>published_highest_cost_plan</span> <span class='op'>=</span> <span class='id identifier rubyid_roster_elected_plan_bounds'>roster_elected_plan_bounds</span><span class='lbracket'>[</span><span class='symbol'>:carrier_high_plan</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_carrier_profile'>carrier_profile</span><span class='period'>.</span><span class='id identifier rubyid_abbrev'>abbrev</span><span class='rbracket'>]</span>
        <span class='kw'>when</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Metal Level</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_plan_option_kind'>plan_option_kind</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>metal_level</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_published_lowest_cost_plan'>published_lowest_cost_plan</span> <span class='op'>=</span> <span class='id identifier rubyid_roster_elected_plan_bounds'>roster_elected_plan_bounds</span><span class='lbracket'>[</span><span class='symbol'>:metal_low_plan</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_metal_level'>metal_level</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_published_highest_cost_plan'>published_highest_cost_plan</span> <span class='op'>=</span> <span class='id identifier rubyid_roster_elected_plan_bounds'>roster_elected_plan_bounds</span><span class='lbracket'>[</span><span class='symbol'>:metal_high_plan</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_metal_level'>metal_level</span><span class='rbracket'>]</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_plan_option_kind'>plan_option_kind</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>single_plan</span><span class='tstring_end'>&quot;</span></span>
          <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_published_lowest_cost_plan'>published_lowest_cost_plan</span> <span class='op'>=</span> <span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
          <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_published_highest_cost_plan'>published_highest_cost_plan</span> <span class='op'>=</span> <span class='id identifier rubyid_plan'>plan</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_column_for_dental_plan_option_kind'>column_for_dental_plan_option_kind</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:elected</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span> <span class='comment'># col 3 is custom, col 1 is single
</span>      <span class='id identifier rubyid_elected_plan_choice'>elected_plan_choice</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>na</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>single_plan</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>single_carrier</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>single_plan</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:elected</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_dental_plan_option_kind'>dental_plan_option_kind</span> <span class='op'>=</span> <span class='id identifier rubyid_elected_plan_choice'>elected_plan_choice</span>
      <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_dental_plan'>dental_plan</span> <span class='op'>=</span> <span class='id identifier rubyid_plan'>plan</span>
      <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_elected_dental_plan_ids'>elected_dental_plan_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:elected_plans_list</span><span class='rbracket'>]</span>
      <span class='comment'># bg.elected_dental_plan_ids = case column_for_dental_plan_option_kind.to_i
</span>      <span class='comment'># when 1
</span>      <span class='comment'>#  [plan.id]
</span>      <span class='comment'># when 2
</span>      <span class='comment'>#  [plan.id]
</span>      <span class='comment'># else
</span>      <span class='comment'>#   params[:elected_plans_list].map{|plan_id| Plan.find(plan_id).id}
</span>      <span class='comment'># end
</span>    <span class='kw'>end</span>
    <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
  <span class='kw'>end</span>
  <span class='ivar'>@benefit_groups</span> <span class='op'>=</span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_html'>html</span> <span class='lbrace'>{</span><span class='id identifier rubyid_render'>render</span> <span class='label'>partial:</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>publish</span><span class='tstring_end'>&#39;</span></span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_pdf'>pdf</span> <span class='kw'>do</span>
        <span class='id identifier rubyid_render'>render</span> <span class='symbol'>:pdf</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>publised_quote</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
               <span class='symbol'>:template</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>/broker_agencies/quotes/_publish.pdf.erb</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="show-instance_method">
  
    #<strong>show</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 37</span>

<span class='kw'>def</span> <span class='id identifier rubyid_show'>show</span> 
  <span class='ivar'>@q</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='ivar'>@benefit_groups</span> <span class='op'>=</span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span>
  <span class='ivar'>@quote_benefit_group</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_group_id</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_group_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='ivar'>@benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

  <span class='comment'>#active_year = Date.today.year
</span>  <span class='ivar'>@coverage_kind</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>health</span><span class='tstring_end'>&quot;</span></span>
  <span class='ivar'>@section</span> <span class='op'>=</span> <span class='op'>!</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:section</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
  <span class='ivar'>@index</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:row</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>

  <span class='ivar'>@health_plans</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plan.html" title="Plan (class)">Plan</a></span></span><span class='period'>.</span><span class='id identifier rubyid_shop_health_plans'><span class='object_link'><a href="../Plan.html#shop_health_plans-class_method" title="Plan.shop_health_plans (method)">shop_health_plans</a></span></span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_plan_year'>plan_year</span>
  <span class='ivar'>@health_selectors</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plan.html" title="Plan (class)">Plan</a></span></span><span class='period'>.</span><span class='id identifier rubyid_build_plan_selectors'><span class='object_link'><a href="../Plan.html#build_plan_selectors-class_method" title="Plan.build_plan_selectors (method)">build_plan_selectors</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>shop</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>health</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_plan_year'>plan_year</span><span class='rparen'>)</span>
  <span class='ivar'>@health_plan_quote_criteria</span>  <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plan.html" title="Plan (class)">Plan</a></span></span><span class='period'>.</span><span class='id identifier rubyid_build_plan_features'><span class='object_link'><a href="../Plan.html#build_plan_features-class_method" title="Plan.build_plan_features (method)">build_plan_features</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>shop</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>health</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_plan_year'>plan_year</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
  <span class='ivar'>@dental_plans</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plan.html" title="Plan (class)">Plan</a></span></span><span class='period'>.</span><span class='id identifier rubyid_shop_dental_plans'><span class='object_link'><a href="../Plan.html#shop_dental_plans-class_method" title="Plan.shop_dental_plans (method)">shop_dental_plans</a></span></span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_plan_year'>plan_year</span>
  <span class='ivar'>@dental_selectors</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plan.html" title="Plan (class)">Plan</a></span></span><span class='period'>.</span><span class='id identifier rubyid_build_plan_selectors'><span class='object_link'><a href="../Plan.html#build_plan_selectors-class_method" title="Plan.build_plan_selectors (method)">build_plan_selectors</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>shop</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dental</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_plan_year'>plan_year</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_dental_plan_quote_criteria'>dental_plan_quote_criteria</span>  <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Plan.html" title="Plan (class)">Plan</a></span></span><span class='period'>.</span><span class='id identifier rubyid_build_plan_features'><span class='object_link'><a href="../Plan.html#build_plan_features-class_method" title="Plan.build_plan_features (method)">build_plan_features</a></span></span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>shop</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dental</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span><span class='ivar'>@q</span><span class='period'>.</span><span class='id identifier rubyid_plan_year'>plan_year</span><span class='rparen'>)</span> <span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
  <span class='ivar'>@dental_plans_count</span> <span class='op'>=</span> <span class='ivar'>@dental_plans</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span>

  <span class='ivar'>@bp_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>employee</span><span class='label_end'>&#39;:</span><span class='int'>50</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>spouse</span><span class='label_end'>&#39;:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>domestic_partner</span><span class='label_end'>&#39;:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>child_under_26</span><span class='label_end'>&#39;:</span> <span class='int'>0</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>child_26_and_over</span><span class='label_end'>&#39;:</span> <span class='int'>0</span><span class='rbrace'>}</span>
  <span class='ivar'>@benefit_pcts_json</span> <span class='op'>=</span> <span class='ivar'>@bp_hash</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
  <span class='ivar'>@quote_criteria</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

  <span class='ivar'>@quote_benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_quote_relationship_benefits'>quote_relationship_benefits</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_bp'>bp</span><span class='op'>|</span> <span class='ivar'>@bp_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_bp'>bp</span><span class='period'>.</span><span class='id identifier rubyid_relationship'>relationship</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_bp'>bp</span><span class='period'>.</span><span class='id identifier rubyid_premium_pct'>premium_pct</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_roster_premiums'>roster_premiums</span> <span class='op'>=</span> <span class='ivar'>@quote_benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_roster_cost_all_plans'>roster_cost_all_plans</span>
  <span class='ivar'>@roster_premiums_json</span> <span class='op'>=</span> <span class='id identifier rubyid_roster_premiums'>roster_premiums</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
  <span class='id identifier rubyid_dental_roster_premiums'>dental_roster_premiums</span> <span class='op'>=</span>  <span class='ivar'>@quote_benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_roster_cost_all_plans'>roster_cost_all_plans</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dental</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='ivar'>@dental_roster_premiums</span> <span class='op'>=</span> <span class='id identifier rubyid_dental_roster_premiums'>dental_roster_premiums</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
  <span class='ivar'>@quote_criteria</span> <span class='op'>=</span> <span class='ivar'>@quote_benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_criteria_for_ui'>criteria_for_ui</span>
  <span class='ivar'>@benefit_pcts_json</span> <span class='op'>=</span> <span class='ivar'>@bp_hash</span><span class='period'>.</span><span class='id identifier rubyid_to_json'>to_json</span>
  <span class='kw'>unless</span> <span class='ivar'>@section</span>
  <span class='id identifier rubyid_respond_to'>respond_to</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
      <span class='id identifier rubyid_format'>format</span><span class='period'>.</span><span class='id identifier rubyid_js'>js</span>
  <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update-instance_method">
  
    #<strong>update</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 149</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update'>update</span>
  <span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_sanitize_quote_roster_params'>sanitize_quote_roster_params</span>

  <span class='comment'># update current attributs then insert new ones. Both can&#39;t be done at the same time.
</span>  <span class='id identifier rubyid_update_params'>update_params</span> <span class='op'>=</span> <span class='id identifier rubyid_quote_params'>quote_params</span>
  <span class='id identifier rubyid_insert_params'>insert_params</span> <span class='op'>=</span> <span class='id identifier rubyid_quote_params'>quote_params</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_update_params'>update_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_households_attributes</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_update_params'>update_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_households_attributes</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_update_params'>update_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_households_attributes</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_update_params'>update_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_households_attributes</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_insert_params'>insert_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_households_attributes</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_insert_params'>insert_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_households_attributes</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_insert_params'>insert_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_households_attributes</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_update_params'>update_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_benefit_groups_attributes</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_update_params'>update_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_benefit_groups_attributes</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_update_params'>update_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_benefit_groups_attributes</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_update_params'>update_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_benefit_groups_attributes</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_insert_params'>insert_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_benefit_groups_attributes</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_insert_params'>insert_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_benefit_groups_attributes</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span><span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_insert_params'>insert_params</span><span class='lbracket'>[</span><span class='symbol'>:quote_benefit_groups_attributes</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span><span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:commit</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Add Employee</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_new_family'>new_family</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='id identifier rubyid_notice_message'>notice_message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>New employee added.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_scrollTo'>scrollTo</span> <span class='op'>=</span> <span class='int'>1</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:commit</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Save Changes</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_new_family'>new_family</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id identifier rubyid_notice_message'>notice_message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Successfully saved quote/employee roster.</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_scrollTo'>scrollTo</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:commit</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Save</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_new_family'>new_family</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span> <span class='op'>:</span> <span class='kw'>true</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:employer_type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prospect</span><span class='tstring_end'>&#39;</span></span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_employer_type'>employer_type</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prospect</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>||</span> <span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:employer_type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>client</span><span class='tstring_end'>&#39;</span></span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile_id'>employer_profile_id</span> <span class='op'>!=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:employer_profile_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span> <span class='kw'>if</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes'>update_attributes</span><span class='lparen'>(</span><span class='label'>employer_profile_id:</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='lparen'>(</span><span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes'>update_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_update_params'>update_params</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes'>update_attributes</span><span class='lparen'>(</span><span class='id identifier rubyid_insert_params'>insert_params</span><span class='rparen'>)</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_duplicate_household'>duplicate_household</span> <span class='op'>=</span> <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_quote_households'>quote_households</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>family_id:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:duplicate_household</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:to_str</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_num_of_dup'>num_of_dup</span> <span class='op'>=</span> <span class='id identifier rubyid_duplicate_household'>duplicate_household</span> <span class='op'>?</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:num_of_dup</span><span class='rbracket'>]</span> <span class='op'>:</span> <span class='kw'>nil</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:commit</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Create Quote</span><span class='tstring_end'>&quot;</span></span>
      <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_broker_agencies_broker_role_quote_path'>broker_agencies_broker_role_quote_path</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:broker_role_id</span><span class='rbracket'>]</span><span class='comma'>,</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_edit_broker_agencies_broker_role_quote_path'>edit_broker_agencies_broker_role_quote_path</span><span class='lparen'>(</span><span class='ivar'>@broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='ivar'>@quote</span><span class='comma'>,</span> <span class='label'>new_family:</span> <span class='id identifier rubyid_new_family'>new_family</span><span class='comma'>,</span> <span class='label'>scrollTo:</span> <span class='id identifier rubyid_scrollTo'>scrollTo</span><span class='comma'>,</span><span class='label'>duplicate_household:</span> <span class='id identifier rubyid_duplicate_household'>duplicate_household</span> <span class='comma'>,</span><span class='label'>num_of_dup:</span> <span class='id identifier rubyid_num_of_dup'>num_of_dup</span><span class='rparen'>)</span><span class='comma'>,</span>  <span class='symbol'>:flash</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:notice</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_notice_message'>notice_message</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='id identifier rubyid_redirect_to'>redirect_to</span> <span class='id identifier rubyid_edit_broker_agencies_broker_role_quote_path'>edit_broker_agencies_broker_role_quote_path</span><span class='lparen'>(</span><span class='ivar'>@broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span> <span class='ivar'>@quote</span><span class='rparen'>)</span> <span class='comma'>,</span>  <span class='symbol'>:flash</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span> <span class='symbol'>:error</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Unable to update the employee roster.</span><span class='tstring_end'>&quot;</span></span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_benefits-instance_method">
  
    #<strong>update_benefits</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


330
331
332
333
334
335
336
337</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 330</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_benefits'>update_benefits</span>
  <span class='id identifier rubyid_benefit_group'>benefit_group</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_id</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_quote_benefit_groups'>quote_benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefit_id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_benefit_group'>benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_quote'>quote</span><span class='period'>.</span><span class='id identifier rubyid_is_complete?'>is_complete?</span>
  <span class='id identifier rubyid_benefits'>benefits</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:benefits</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_relationship_benefits'>relationship_benefits</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:coverage_kind</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>dental</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span>  <span class='id identifier rubyid_benefit_group'>benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_quote_relationship_benefits'>quote_relationship_benefits</span> <span class='op'>:</span> <span class='id identifier rubyid_benefit_group'>benefit_group</span><span class='period'>.</span><span class='id identifier rubyid_quote_dental_relationship_benefits'>quote_dental_relationship_benefits</span>
  <span class='id identifier rubyid_relationship_benefits'>relationship_benefits</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_b'>b</span><span class='op'>|</span> <span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes!'>update_attributes!</span><span class='lparen'>(</span><span class='label'>premium_pct:</span> <span class='id identifier rubyid_benefits'>benefits</span><span class='lbracket'>[</span><span class='id identifier rubyid_b'>b</span><span class='period'>.</span><span class='id identifier rubyid_relationship'>relationship</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_render'>render</span> <span class='label'>json:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="upload_employee_roster-instance_method">
  
    #<strong>upload_employee_roster</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


249
250
251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 249</span>

<span class='kw'>def</span> <span class='id identifier rubyid_upload_employee_roster'>upload_employee_roster</span>
  <span class='ivar'>@quote</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../Quote.html" title="Quote (class)">Quote</a></span></span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span><span class='lparen'>(</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_emp'>emp</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>prospect</span><span class='tstring_end'>&#39;</span></span> <span class='op'>?</span> <span class='lbrace'>{</span> <span class='label'>employer_name:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span> <span class='rbrace'>}</span> <span class='op'>:</span> <span class='lbrace'>{</span><span class='label'>employer_profile_id:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:profile_id</span><span class='rbracket'>]</span><span class='rbrace'>}</span>
  <span class='ivar'>@quote</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes'>update_attributes</span><span class='lparen'>(</span><span class='lbrace'>{</span><span class='label'>employer_type:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:type</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>start_on:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:effective_date</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='label'>quote_name:</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='symbol'>:quote_name</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span><span class='id identifier rubyid_emp'>emp</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="view_published_quote-instance_method">
  
    #<strong>view_published_quote</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/controllers/broker_agencies/quotes_controller.rb', line 11</span>

<span class='kw'>def</span> <span class='id identifier rubyid_view_published_quote'>view_published_quote</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Oct 11 09:50:35 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.2.3).
</div>

    </div>
  </body>
</html>