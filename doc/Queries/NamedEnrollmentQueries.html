<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Queries::NamedEnrollmentQueries
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Queries::NamedEnrollmentQueries";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (N)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Queries.html" title="Queries (module)">Queries</a></span></span>
     &raquo; 
    <span class="title">NamedEnrollmentQueries</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Queries::NamedEnrollmentQueries
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Queries::NamedEnrollmentQueries</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/queries/named_enrollment_queries.rb</dd>
  </dl>
  
</div>

<h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="NamedEnrollmentQueries/EnrollmentCounter.html" title="Queries::NamedEnrollmentQueries::EnrollmentCounter (class)">EnrollmentCounter</a></span>, <span class='object_link'><a href="NamedEnrollmentQueries/InitialEnrollmentFilter.html" title="Queries::NamedEnrollmentQueries::InitialEnrollmentFilter (class)">InitialEnrollmentFilter</a></span>, <span class='object_link'><a href="NamedEnrollmentQueries/RenewalSimulationEligibleFilter.html" title="Queries::NamedEnrollmentQueries::RenewalSimulationEligibleFilter (class)">RenewalSimulationEligibleFilter</a></span>, <span class='object_link'><a href="NamedEnrollmentQueries/RenewalTransmissionEligibleFilter.html" title="Queries::NamedEnrollmentQueries::RenewalTransmissionEligibleFilter (class)">RenewalTransmissionEligibleFilter</a></span>
    
  
</p>







  
    <h2>
      Class Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_ie_sponsored_benefits-class_method" title="find_ie_sponsored_benefits (class method)">.<strong>find_ie_sponsored_benefits</strong>(organization, effective_on)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_renewal_sponsored_benefits-class_method" title="find_renewal_sponsored_benefits (class method)">.<strong>find_renewal_sponsored_benefits</strong>(organization, effective_on)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_renewal_transmission_enrollments-class_method" title="find_renewal_transmission_enrollments (class method)">.<strong>find_renewal_transmission_enrollments</strong>(sb, as_of_time)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_simulated_renewal_enrollments-class_method" title="find_simulated_renewal_enrollments (class method)">.<strong>find_simulated_renewal_enrollments</strong>(sponsored_benefits, effective_on, as_of_time = ::TimeKeeper.date_of_record)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initial_sponsored_benefit_last_cancel_chance-class_method" title="initial_sponsored_benefit_last_cancel_chance (class method)">.<strong>initial_sponsored_benefit_last_cancel_chance</strong>(sb)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#new_enrollment_statuses-class_method" title="new_enrollment_statuses (class method)">.<strong>new_enrollment_statuses</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#query_for_initial_sponsored_benefit-class_method" title="query_for_initial_sponsored_benefit (class method)">.<strong>query_for_initial_sponsored_benefit</strong>(sb, effective_on)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#renewal_gate_lifted_enrollments-class_method" title="renewal_gate_lifted_enrollments (class method)">.<strong>renewal_gate_lifted_enrollments</strong>(organization, effective_on, as_of_time = ::TimeKeeper.date_of_record)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shop_initial_enrollments-class_method" title="shop_initial_enrollments (class method)">.<strong>shop_initial_enrollments</strong>(organization, effective_on)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  



  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="find_ie_sponsored_benefits-class_method">
  
    .<strong>find_ie_sponsored_benefits</strong>(organization, effective_on)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


235
236
237
238
239
240
241
242
243</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/queries/named_enrollment_queries.rb', line 235</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_ie_sponsored_benefits'>find_ie_sponsored_benefits</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_benefit_sponsorships'>benefit_sponsorships</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>BenefitSponsors</span><span class='op'>::</span><span class='const'>BenefitSponsorships</span><span class='op'>::</span><span class='const'>BenefitSponsorship</span><span class='period'>.</span><span class='id identifier rubyid_by_profile'>by_profile</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_may_transmit_initial_enrollment?'>may_transmit_initial_enrollment?</span><span class='lparen'>(</span><span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_benefit_sponsorships'>benefit_sponsorships</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_bs'>bs</span><span class='op'>|</span>
    <span class='id identifier rubyid_bs'>bs</span><span class='period'>.</span><span class='id identifier rubyid_benefit_applications'>benefit_applications</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ba'>ba</span><span class='op'>|</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_ba'>ba</span><span class='period'>.</span><span class='id identifier rubyid_start_on'>start_on</span> <span class='op'>==</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>enrollment_eligible</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_ba'>ba</span><span class='period'>.</span><span class='id identifier rubyid_aasm_state'>aasm_state</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:benefit_packages</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:sponsored_benefits</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_renewal_sponsored_benefits-class_method">
  
    .<strong>find_renewal_sponsored_benefits</strong>(organization, effective_on)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


225
226
227
228
229
230
231
232
233</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/queries/named_enrollment_queries.rb', line 225</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_renewal_sponsored_benefits'>find_renewal_sponsored_benefits</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_benefit_sponsorships'>benefit_sponsorships</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>BenefitSponsors</span><span class='op'>::</span><span class='const'>BenefitSponsorships</span><span class='op'>::</span><span class='const'>BenefitSponsorship</span><span class='period'>.</span><span class='id identifier rubyid_by_profile'>by_profile</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_eligible_renewal_applications_on'>eligible_renewal_applications_on</span><span class='lparen'>(</span><span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_benefit_sponsorships'>benefit_sponsorships</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_bs'>bs</span><span class='op'>|</span>
    <span class='id identifier rubyid_bs'>bs</span><span class='period'>.</span><span class='id identifier rubyid_benefit_applications'>benefit_applications</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_ba'>ba</span><span class='op'>|</span>
      <span class='lparen'>(</span><span class='id identifier rubyid_ba'>ba</span><span class='period'>.</span><span class='id identifier rubyid_start_on'>start_on</span> <span class='op'>==</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>active</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>enrollment_eligible</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_ba'>ba</span><span class='period'>.</span><span class='id identifier rubyid_aasm_state'>aasm_state</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:benefit_packages</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flat_map'>flat_map</span><span class='lparen'>(</span><span class='op'>&amp;</span><span class='symbol'>:sponsored_benefits</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_renewal_transmission_enrollments-class_method">
  
    .<strong>find_renewal_transmission_enrollments</strong>(sb, as_of_time)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/queries/named_enrollment_queries.rb', line 192</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_renewal_transmission_enrollments'>find_renewal_transmission_enrollments</span><span class='lparen'>(</span><span class='id identifier rubyid_sb'>sb</span><span class='comma'>,</span> <span class='id identifier rubyid_as_of_time'>as_of_time</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sb_id'>sb_id</span> <span class='op'>=</span> <span class='id identifier rubyid_sb'>sb</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
  <span class='const'><span class='object_link'><a href="../Family.html" title="Family (class)">Family</a></span></span><span class='period'>.</span><span class='id identifier rubyid_collection'>collection</span><span class='period'>.</span><span class='id identifier rubyid_aggregate'>aggregate</span><span class='lparen'>(</span><span class='lbracket'>[</span>
    <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$match</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.sponsored_benefit_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_sb_id'>sb_id</span>
      <span class='rbrace'>}</span>
    <span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$unwind</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$unwind</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$match</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.sponsored_benefit_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_sb_id'>sb_id</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.aasm_state</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$in</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_new_enrollment_statuses'>new_enrollment_statuses</span><span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.kind</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$in</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>employer_sponsored</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>employer_sponsored_cobra</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.submitted_at</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$lte</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_as_of_time'>as_of_time</span><span class='rbrace'>}</span>
    <span class='rbrace'>}</span><span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$sort</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.submitted_at</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='rbrace'>}</span><span class='rbrace'>}</span><span class='comma'>,</span>
    <span class='lbrace'>{</span>
      <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$group</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>employee_role_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.employee_role_id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sponsored_benefit_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.sponsored_benefit_id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>effective_on</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.effective_on</span><span class='tstring_end'>&quot;</span></span>
        <span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hbx_enrollment_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$last</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.hbx_id</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>aasm_state</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$last</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.aasm_state</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>submitted_at</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$last</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.submitted_at</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>product_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$last</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.product_id</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
      <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
  <span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_simulated_renewal_enrollments-class_method">
  
    .<strong>find_simulated_renewal_enrollments</strong>(sponsored_benefits, effective_on, as_of_time = ::TimeKeeper.date_of_record)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


185
186
187
188
189
190</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/queries/named_enrollment_queries.rb', line 185</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_find_simulated_renewal_enrollments'>find_simulated_renewal_enrollments</span><span class='lparen'>(</span><span class='id identifier rubyid_sponsored_benefits'>sponsored_benefits</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='comma'>,</span> <span class='id identifier rubyid_as_of_time'>as_of_time</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../TimeKeeper.html" title="TimeKeeper (class)">TimeKeeper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_date_of_record'><span class='object_link'><a href="../TimeKeeper.html#date_of_record-class_method" title="TimeKeeper.date_of_record (method)">date_of_record</a></span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_aggregations'>aggregations</span> <span class='op'>=</span> <span class='id identifier rubyid_sponsored_benefits'>sponsored_benefits</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sb'>sb</span><span class='op'>|</span>
    <span class='id identifier rubyid_find_renewal_transmission_enrollments'>find_renewal_transmission_enrollments</span><span class='lparen'>(</span><span class='id identifier rubyid_sb'>sb</span><span class='comma'>,</span> <span class='id identifier rubyid_as_of_time'>as_of_time</span> <span class='op'>+</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_day'>day</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='const'><span class='object_link'><a href="NamedEnrollmentQueries/RenewalSimulationEligibleFilter.html" title="Queries::NamedEnrollmentQueries::RenewalSimulationEligibleFilter (class)">RenewalSimulationEligibleFilter</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="NamedEnrollmentQueries/RenewalSimulationEligibleFilter.html#initialize-instance_method" title="Queries::NamedEnrollmentQueries::RenewalSimulationEligibleFilter#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_aggregations'>aggregations</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="initial_sponsored_benefit_last_cancel_chance-class_method">
  
    .<strong>initial_sponsored_benefit_last_cancel_chance</strong>(sb)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/queries/named_enrollment_queries.rb', line 138</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_initial_sponsored_benefit_last_cancel_chance'>initial_sponsored_benefit_last_cancel_chance</span><span class='lparen'>(</span><span class='id identifier rubyid_sb'>sb</span><span class='rparen'>)</span>
  <span class='const'><span class='object_link'><a href="../TimeKeeper.html" title="TimeKeeper (class)">TimeKeeper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_end_of_exchange_day_from_utc'><span class='object_link'><a href="../TimeKeeper.html#end_of_exchange_day_from_utc-class_method" title="TimeKeeper.end_of_exchange_day_from_utc (method)">end_of_exchange_day_from_utc</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_sb'>sb</span><span class='period'>.</span><span class='id identifier rubyid_benefit_package'>benefit_package</span><span class='period'>.</span><span class='id identifier rubyid_open_enrollment_end_on'>open_enrollment_end_on</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="new_enrollment_statuses-class_method">
  
    .<strong>new_enrollment_statuses</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


245
246
247</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/queries/named_enrollment_queries.rb', line 245</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_new_enrollment_statuses'>new_enrollment_statuses</span>
  <span class='const'><span class='object_link'><a href="../HbxEnrollment.html" title="HbxEnrollment (class)">HbxEnrollment</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../HbxEnrollment.html#ENROLLED_STATUSES-constant" title="HbxEnrollment::ENROLLED_STATUSES (constant)">ENROLLED_STATUSES</a></span></span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../HbxEnrollment.html" title="HbxEnrollment (class)">HbxEnrollment</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../HbxEnrollment.html#RENEWAL_STATUSES-constant" title="HbxEnrollment::RENEWAL_STATUSES (constant)">RENEWAL_STATUSES</a></span></span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../HbxEnrollment.html" title="HbxEnrollment (class)">HbxEnrollment</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../HbxEnrollment.html#TERMINATED_STATUSES-constant" title="HbxEnrollment::TERMINATED_STATUSES (constant)">TERMINATED_STATUSES</a></span></span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../HbxEnrollment.html" title="HbxEnrollment (class)">HbxEnrollment</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../HbxEnrollment.html#CANCELED_STATUSES-constant" title="HbxEnrollment::CANCELED_STATUSES (constant)">CANCELED_STATUSES</a></span></span> <span class='op'>+</span> <span class='const'><span class='object_link'><a href="../HbxEnrollment.html" title="HbxEnrollment (class)">HbxEnrollment</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../HbxEnrollment.html#WAIVED_STATUSES-constant" title="HbxEnrollment::WAIVED_STATUSES (constant)">WAIVED_STATUSES</a></span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="query_for_initial_sponsored_benefit-class_method">
  
    .<strong>query_for_initial_sponsored_benefit</strong>(sb, effective_on)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/queries/named_enrollment_queries.rb', line 142</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_query_for_initial_sponsored_benefit'>query_for_initial_sponsored_benefit</span><span class='lparen'>(</span><span class='id identifier rubyid_sb'>sb</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_sb_id'>sb_id</span> <span class='op'>=</span> <span class='id identifier rubyid_sb'>sb</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
    <span class='id identifier rubyid_threshold_time'>threshold_time</span> <span class='op'>=</span> <span class='id identifier rubyid_initial_sponsored_benefit_last_cancel_chance'>initial_sponsored_benefit_last_cancel_chance</span><span class='lparen'>(</span><span class='id identifier rubyid_sb'>sb</span><span class='rparen'>)</span>
    <span class='const'><span class='object_link'><a href="../Family.html" title="Family (class)">Family</a></span></span><span class='period'>.</span><span class='id identifier rubyid_collection'>collection</span><span class='period'>.</span><span class='id identifier rubyid_aggregate'>aggregate</span><span class='lparen'>(</span><span class='lbracket'>[</span>
      <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$match</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.sponsored_benefit_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_sb_id'>sb_id</span>
        <span class='rbrace'>}</span>
      <span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$unwind</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$unwind</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$match</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.sponsored_benefit_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_sb_id'>sb_id</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.aasm_state</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$in</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_new_enrollment_statuses'>new_enrollment_statuses</span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.effective_on</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.kind</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$in</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>employer_sponsored</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>employer_sponsored_cobra</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.submitted_at</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$lte</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_threshold_time'>threshold_time</span><span class='rbrace'>}</span>
      <span class='rbrace'>}</span><span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$sort</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>households.hbx_enrollments.submitted_at</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='int'>1</span><span class='rbrace'>}</span><span class='rbrace'>}</span><span class='comma'>,</span>
      <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$group</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>employee_role_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.employee_role_id</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>sponsored_benefit_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.sponsored_benefit_id</span><span class='tstring_end'>&quot;</span></span>
          <span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>hbx_enrollment_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$last</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.hbx_id</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>aasm_state</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$last</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.aasm_state</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>submitted_at</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$last</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.submitted_at</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>workflow_state_transitions</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$last</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.workflow_state_transitions</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span><span class='comma'>,</span>
          <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>product_id</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$last</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>$households.hbx_enrollments.product_id</span><span class='tstring_end'>&quot;</span></span><span class='rbrace'>}</span>
        <span class='rbrace'>}</span>
      <span class='rbrace'>}</span>
    <span class='rbracket'>]</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="renewal_gate_lifted_enrollments-class_method">
  
    .<strong>renewal_gate_lifted_enrollments</strong>(organization, effective_on, as_of_time = ::TimeKeeper.date_of_record)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


177
178
179
180
181
182
183</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/queries/named_enrollment_queries.rb', line 177</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_renewal_gate_lifted_enrollments'>renewal_gate_lifted_enrollments</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='comma'>,</span> <span class='id identifier rubyid_as_of_time'>as_of_time</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'><span class='object_link'><a href="../TimeKeeper.html" title="TimeKeeper (class)">TimeKeeper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_date_of_record'><span class='object_link'><a href="../TimeKeeper.html#date_of_record-class_method" title="TimeKeeper.date_of_record (method)">date_of_record</a></span></span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sponsored_benefits'>sponsored_benefits</span> <span class='op'>=</span> <span class='id identifier rubyid_find_renewal_sponsored_benefits'>find_renewal_sponsored_benefits</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_aggregations'>aggregations</span> <span class='op'>=</span> <span class='id identifier rubyid_sponsored_benefits'>sponsored_benefits</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sb'>sb</span><span class='op'>|</span>
    <span class='id identifier rubyid_find_renewal_transmission_enrollments'>find_renewal_transmission_enrollments</span><span class='lparen'>(</span><span class='id identifier rubyid_sb'>sb</span><span class='comma'>,</span> <span class='id identifier rubyid_as_of_time'>as_of_time</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='const'><span class='object_link'><a href="NamedEnrollmentQueries/RenewalTransmissionEligibleFilter.html" title="Queries::NamedEnrollmentQueries::RenewalTransmissionEligibleFilter (class)">RenewalTransmissionEligibleFilter</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="NamedEnrollmentQueries/RenewalTransmissionEligibleFilter.html#initialize-instance_method" title="Queries::NamedEnrollmentQueries::RenewalTransmissionEligibleFilter#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_aggregations'>aggregations</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="shop_initial_enrollments-class_method">
  
    .<strong>shop_initial_enrollments</strong>(organization, effective_on)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


127
128
129
130
131
132
133
134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/queries/named_enrollment_queries.rb', line 127</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_shop_initial_enrollments'>shop_initial_enrollments</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_sponsored_benefits'>sponsored_benefits</span> <span class='op'>=</span> <span class='id identifier rubyid_find_ie_sponsored_benefits'>find_ie_sponsored_benefits</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_last_chance_to_cancel_at'>last_chance_to_cancel_at</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='id identifier rubyid_queries'>queries</span> <span class='op'>=</span> <span class='id identifier rubyid_sponsored_benefits'>sponsored_benefits</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_sb'>sb</span><span class='op'>|</span>
    <span class='id identifier rubyid_last_chance_to_cancel_at'>last_chance_to_cancel_at</span> <span class='op'>=</span> <span class='id identifier rubyid_initial_sponsored_benefit_last_cancel_chance'>initial_sponsored_benefit_last_cancel_chance</span><span class='lparen'>(</span><span class='id identifier rubyid_sb'>sb</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_query_for_initial_sponsored_benefit'>query_for_initial_sponsored_benefit</span><span class='lparen'>(</span><span class='id identifier rubyid_sb'>sb</span><span class='comma'>,</span> <span class='id identifier rubyid_effective_on'>effective_on</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='const'><span class='object_link'><a href="NamedEnrollmentQueries/InitialEnrollmentFilter.html" title="Queries::NamedEnrollmentQueries::InitialEnrollmentFilter (class)">InitialEnrollmentFilter</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="NamedEnrollmentQueries/InitialEnrollmentFilter.html#initialize-instance_method" title="Queries::NamedEnrollmentQueries::InitialEnrollmentFilter#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_last_chance_to_cancel_at'>last_chance_to_cancel_at</span><span class='comma'>,</span> <span class='id identifier rubyid_queries'>queries</span><span class='rparen'>)</span> 
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Oct 11 09:50:25 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.2.3).
</div>

    </div>
  </body>
</html>