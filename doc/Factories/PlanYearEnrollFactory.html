<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Factories::PlanYearEnrollFactory
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Factories::PlanYearEnrollFactory";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (P)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Factories.html" title="Factories (module)">Factories</a></span></span>
     &raquo; 
    <span class="title">PlanYearEnrollFactory</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Factories::PlanYearEnrollFactory
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Factories::PlanYearEnrollFactory</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/factories/plan_year_enroll_factory.rb</dd>
  </dl>
  
</div>





  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#benefit_group_ids-instance_method" title="#benefit_group_ids (instance method)">#<strong>benefit_group_ids</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute benefit_group_ids.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#employer_profile-instance_method" title="#employer_profile (instance method)">#<strong>employer_profile</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute employer_profile.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#end_on-instance_method" title="#end_on (instance method)">#<strong>end_on</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute end_on.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#missing_family-instance_method" title="#missing_family (instance method)">#<strong>missing_family</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute missing_family.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#missing_person-instance_method" title="#missing_person (instance method)">#<strong>missing_person</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute missing_person.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#start_on-instance_method" title="#start_on (instance method)">#<strong>start_on</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute start_on.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#begin_employee_coverage-instance_method" title="#begin_employee_coverage (instance method)">#<strong>begin_employee_coverage</strong>(census_employee)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_active_benefit_group_assignments-instance_method" title="#create_active_benefit_group_assignments (instance method)">#<strong>create_active_benefit_group_assignments</strong>(benefit_groups)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#enroll-instance_method" title="#enroll (instance method)">#<strong>enroll</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#enroll_employer_profile-instance_method" title="#enroll_employer_profile (instance method)">#<strong>enroll_employer_profile</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>  &#x21d2; PlanYearEnrollFactory </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of PlanYearEnrollFactory.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#terminate_employee_coverage-instance_method" title="#terminate_employee_coverage (instance method)">#<strong>terminate_employee_coverage</strong>(census_employee)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#valid_enrollment%3F-instance_method" title="#valid_enrollment? (instance method)">#<strong>valid_enrollment?</strong>(hbx_enrollment, renewal_enrollment)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#waived_benefit_group_assignment-instance_method" title="#waived_benefit_group_assignment (instance method)">#<strong>waived_benefit_group_assignment</strong>(census_employee)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  

<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>  &#x21d2; <tt><span class='object_link'><a href="" title="Factories::PlanYearEnrollFactory (class)">PlanYearEnrollFactory</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of PlanYearEnrollFactory</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


6
7
8
9</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 6</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span>
  <span class='ivar'>@missing_person</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@missing_family</span> <span class='op'>=</span> <span class='int'>0</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="benefit_group_ids=-instance_method"></span>
      <div class="method_details first">
  <h3 class="signature first" id="benefit_group_ids-instance_method">
  
    #<strong>benefit_group_ids</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute benefit_group_ids</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_benefit_group_ids'>benefit_group_ids</span>
  <span class='ivar'>@benefit_group_ids</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="employer_profile=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="employer_profile-instance_method">
  
    #<strong>employer_profile</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute employer_profile</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_employer_profile'>employer_profile</span>
  <span class='ivar'>@employer_profile</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="end_on=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="end_on-instance_method">
  
    #<strong>end_on</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute end_on</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_end_on'>end_on</span>
  <span class='ivar'>@end_on</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="missing_family=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="missing_family-instance_method">
  
    #<strong>missing_family</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute missing_family</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_missing_family'>missing_family</span>
  <span class='ivar'>@missing_family</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="missing_person=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="missing_person-instance_method">
  
    #<strong>missing_person</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute missing_person</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_missing_person'>missing_person</span>
  <span class='ivar'>@missing_person</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="start_on=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="start_on-instance_method">
  
    #<strong>start_on</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute start_on</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start_on'>start_on</span>
  <span class='ivar'>@start_on</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="begin_employee_coverage-instance_method">
  
    #<strong>begin_employee_coverage</strong>(census_employee)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 75</span>

<span class='kw'>def</span> <span class='id identifier rubyid_begin_employee_coverage'>begin_employee_coverage</span><span class='lparen'>(</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_person'>person</span> <span class='op'>=</span> <span class='id identifier rubyid_match_person'>match_person</span><span class='lparen'>(</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_family'>family</span> <span class='op'>=</span> <span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_primary_family'>primary_family</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_family'>family</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='ivar'>@count</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='ivar'>@missing_family</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="PlanYearPublishFactoryError.html" title="Factories::PlanYearPublishFactoryError (class)">PlanYearPublishFactoryError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Family don&#39;t exist!!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_current_enrollments'>current_enrollments</span> <span class='op'>=</span> <span class='id identifier rubyid_family'>family</span><span class='period'>.</span><span class='id identifier rubyid_active_household'>active_household</span><span class='period'>.</span><span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>effective_on:</span> <span class='lparen'>(</span><span class='ivar'>@start_on</span><span class='op'>..</span><span class='ivar'>@end_on</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_shop_market'>shop_market</span>

  <span class='id identifier rubyid_enrolled_enrollments'>enrolled_enrollments</span> <span class='op'>=</span> <span class='id identifier rubyid_current_enrollments'>current_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_enrolled'>enrolled</span>
  <span class='id identifier rubyid_renewing_enrollments'>renewing_enrollments</span> <span class='op'>=</span> <span class='id identifier rubyid_current_enrollments'>current_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_renewing'>renewing</span> <span class='op'>+</span> <span class='id identifier rubyid_current_enrollments'>current_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:aasm_state</span><span class='period'>.</span><span class='id identifier rubyid_in'>in</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>renewing_waived</span><span class='tstring_end'>&quot;</span></span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_enrolled_enrollments'>enrolled_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span> <span class='op'>||</span> <span class='id identifier rubyid_renewing_enrollments'>renewing_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
    <span class='ivar'>@count</span> <span class='op'>+=</span> <span class='int'>1</span> 
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="PlanYearPublishFactoryError.html" title="Factories::PlanYearPublishFactoryError (class)">PlanYearPublishFactoryError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>More than one </span><span class='embexpr_beg'>#{</span><span class='const'><span class='object_link'><a href="../TimeKeeper.html" title="TimeKeeper (class)">TimeKeeper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_date_of_record'><span class='object_link'><a href="../TimeKeeper.html#date_of_record-class_method" title="TimeKeeper.date_of_record (method)">date_of_record</a></span></span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span><span class='embexpr_end'>}</span><span class='tstring_content'> coverage found!!</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_enrolled_enrollments'>enrolled_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_renewing_enrollments'>renewing_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>1</span>
    <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span> <span class='op'>=</span> <span class='id identifier rubyid_enrolled_enrollments'>enrolled_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='id identifier rubyid_renewal_enrollment'>renewal_enrollment</span> <span class='op'>=</span> <span class='id identifier rubyid_renewing_enrollments'>renewing_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_valid_enrollment?'>valid_enrollment?</span><span class='lparen'>(</span><span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='comma'>,</span> <span class='id identifier rubyid_renewal_enrollment'>renewal_enrollment</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_begin_coverage!'>begin_coverage!</span>
      <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span><span class='period'>.</span><span class='id identifier rubyid_begin_benefit'>begin_benefit</span>
      <span class='id identifier rubyid_renewal_enrollment'>renewal_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_cancel_coverage!'>cancel_coverage!</span>
    <span class='kw'>else</span>
      <span class='ivar'>@count</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="PlanYearPublishFactoryError.html" title="Factories::PlanYearPublishFactoryError (class)">PlanYearPublishFactoryError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Hbx enrollment can&#39;t be enrolled updated_at </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span><span class='period'>.</span><span class='id identifier rubyid_strftime'>strftime</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>%m-%d-%Y</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_renewing_enrollments'>renewing_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_effective_on'>effective_on</span> <span class='op'>&lt;=</span> <span class='const'><span class='object_link'><a href="../TimeKeeper.html" title="TimeKeeper (class)">TimeKeeper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_date_of_record'><span class='object_link'><a href="../TimeKeeper.html#date_of_record-class_method" title="TimeKeeper.date_of_record (method)">date_of_record</a></span></span>
      <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_begin_coverage!'>begin_coverage!</span>
      <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_is_coverage_waived?'>is_coverage_waived?</span> <span class='op'>?</span> <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span><span class='period'>.</span><span class='id identifier rubyid_waive_benefit'>waive_benefit</span> <span class='op'>:</span> <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span><span class='period'>.</span><span class='id identifier rubyid_begin_benefit'>begin_benefit</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_enrolled_enrollments'>enrolled_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='op'>|</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_effective_on'>effective_on</span> <span class='op'>&lt;=</span> <span class='const'><span class='object_link'><a href="../TimeKeeper.html" title="TimeKeeper (class)">TimeKeeper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_date_of_record'><span class='object_link'><a href="../TimeKeeper.html#date_of_record-class_method" title="TimeKeeper.date_of_record (method)">date_of_record</a></span></span>
      <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_begin_coverage!'>begin_coverage!</span>
      <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_assignment'>benefit_group_assignment</span><span class='period'>.</span><span class='id identifier rubyid_begin_benefit'>begin_benefit</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_expire_previous_year_enrollments'>expire_previous_year_enrollments</span><span class='lparen'>(</span><span class='id identifier rubyid_family'>family</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_active_benefit_group_assignments-instance_method">
  
    #<strong>create_active_benefit_group_assignments</strong>(benefit_groups)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 47</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_active_benefit_group_assignments'>create_active_benefit_group_assignments</span><span class='lparen'>(</span><span class='id identifier rubyid_benefit_groups'>benefit_groups</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_benefit_group_ids'>benefit_group_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_benefit_groups'>benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_pluck'>pluck</span><span class='lparen'>(</span><span class='symbol'>:_id</span><span class='rparen'>)</span>

  <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_census_employees'>census_employees</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='op'>|</span>
    <span class='kw'>next</span> <span class='kw'>unless</span> <span class='id identifier rubyid_census_employee'>census_employee</span><span class='period'>.</span><span class='id identifier rubyid_is_active?'>is_active?</span>
    <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_census_employee'>census_employee</span><span class='period'>.</span><span class='id identifier rubyid_active_benefit_group_assignment'>active_benefit_group_assignment</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_benefit_group_ids'>benefit_group_ids</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='period'>.</span><span class='id identifier rubyid_active_benefit_group_assignment'>active_benefit_group_assignment</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_id'>benefit_group_id</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_valid_bg_assignment'>valid_bg_assignment</span> <span class='op'>=</span> <span class='id identifier rubyid_census_employee'>census_employee</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_assignments'>benefit_group_assignments</span><span class='period'>.</span><span class='id identifier rubyid_renewing'>renewing</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_bg_assignment'>bg_assignment</span><span class='op'>|</span> <span class='id identifier rubyid_benefit_group_ids'>benefit_group_ids</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_bg_assignment'>bg_assignment</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_id'>benefit_group_id</span><span class='rparen'>)</span><span class='rbrace'>}</span>
      <span class='id identifier rubyid_count'>count</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='id identifier rubyid_valid_bg_assignment'>valid_bg_assignment</span><span class='period'>.</span><span class='id identifier rubyid_make_active'>make_active</span>
    <span class='kw'>end</span>

    <span class='comment'># if census_employee.benefit_group_assignments.none? {|bg_assignment| benefit_group_ids.include?(bg_assignment.benefit_group_id)}
</span>    <span class='comment'>#   census_employee.add_benefit_group_assignment(benefit_groups.first, benefit_groups.first.start_on)
</span>    <span class='comment'># end
</span>  <span class='kw'>end</span>

  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Added benefit group assignments for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_count'>count</span><span class='embexpr_end'>}</span><span class='tstring_content'> employees!!</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="enroll-instance_method">
  
    #<strong>enroll</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 11</span>

<span class='kw'>def</span> <span class='id identifier rubyid_enroll'>enroll</span>
  <span class='id identifier rubyid_published_plan_years'>published_plan_years</span> <span class='op'>=</span> <span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_plan_years'>plan_years</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:start_on</span><span class='tstring_end'>&quot;</span></span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_start_on'>start_on</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_any_of'>any_of</span><span class='lparen'>(</span><span class='lbracket'>[</span><span class='const'><span class='object_link'><a href="../PlanYear.html" title="PlanYear (class)">PlanYear</a></span></span><span class='period'>.</span><span class='id identifier rubyid_published'>published</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='comma'>,</span> <span class='const'><span class='object_link'><a href="../PlanYear.html" title="PlanYear (class)">PlanYear</a></span></span><span class='period'>.</span><span class='id identifier rubyid_renewing_published_state'>renewing_published_state</span><span class='period'>.</span><span class='id identifier rubyid_selector'>selector</span><span class='rbracket'>]</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_published_plan_years'>published_plan_years</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="PlanYearPublishFactoryError.html" title="Factories::PlanYearPublishFactoryError (class)">PlanYearPublishFactoryError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Found zero Renewal/Published Plan Years for Employer </span><span class='embexpr_beg'>#{</span><span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_legal_name'>legal_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_published_plan_years'>published_plan_years</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'><span class='object_link'><a href="PlanYearPublishFactoryError.html" title="Factories::PlanYearPublishFactoryError (class)">PlanYearPublishFactoryError</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Found more than one Renewal/Published Plan Years for Employer </span><span class='embexpr_beg'>#{</span><span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_legal_name'>legal_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='ivar'>@end_on</span> <span class='op'>=</span> <span class='id identifier rubyid_published_plan_years'>published_plan_years</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_end_on'>end_on</span>

  <span class='ivar'>@count</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_census_employees'>census_employees</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='op'>|</span>
    <span class='kw'>begin</span>
      <span class='id identifier rubyid_census_employee'>census_employee</span><span class='period'>.</span><span class='id identifier rubyid_is_active?'>is_active?</span> <span class='op'>?</span> <span class='id identifier rubyid_begin_employee_coverage'>begin_employee_coverage</span><span class='lparen'>(</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='rparen'>)</span> <span class='op'>:</span> <span class='id identifier rubyid_terminate_employee_coverage'>terminate_employee_coverage</span><span class='lparen'>(</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Processed </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Exception </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_inspect'>inspect</span><span class='embexpr_end'>}</span><span class='tstring_content'> occured for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='period'>.</span><span class='id identifier rubyid_full_name'>full_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Processed </span><span class='embexpr_beg'>#{</span><span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_census_employees'>census_employees</span><span class='period'>.</span><span class='id identifier rubyid_count'>count</span><span class='embexpr_end'>}</span><span class='tstring_content'> census employees, skipped </span><span class='embexpr_beg'>#{</span><span class='ivar'>@count</span><span class='embexpr_end'>}</span><span class='tstring_content'> census employee records</span><span class='tstring_end'>&quot;</span></span>

  <span class='id identifier rubyid_published_plan_years'>published_plan_years</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_plan_year'>plan_year</span><span class='op'>|</span> <span class='id identifier rubyid_plan_year'>plan_year</span><span class='period'>.</span><span class='id identifier rubyid_activate!'>activate!</span> <span class='kw'>if</span> <span class='id identifier rubyid_plan_year'>plan_year</span><span class='period'>.</span><span class='id identifier rubyid_may_activate?'>may_activate?</span> <span class='rbrace'>}</span>
  <span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_plan_years'>plan_years</span><span class='period'>.</span><span class='id identifier rubyid_published'>published</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:start_on</span> <span class='op'>=&gt;</span> <span class='lparen'>(</span><span class='id identifier rubyid_start_on'>start_on</span> <span class='op'>-</span> <span class='int'>1</span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_plan_year'>plan_year</span><span class='op'>|</span>
    <span class='id identifier rubyid_plan_year'>plan_year</span><span class='period'>.</span><span class='id identifier rubyid_expire!'>expire!</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_benefit_groups'>benefit_groups</span> <span class='op'>=</span> <span class='id identifier rubyid_published_plan_years'>published_plan_years</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span><span class='period'>.</span><span class='id identifier rubyid_benefit_groups'>benefit_groups</span>

  <span class='id identifier rubyid_enroll_employer_profile'>enroll_employer_profile</span>
  <span class='id identifier rubyid_create_active_benefit_group_assignments'>create_active_benefit_group_assignments</span><span class='lparen'>(</span><span class='id identifier rubyid_benefit_groups'>benefit_groups</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="enroll_employer_profile-instance_method">
  
    #<strong>enroll_employer_profile</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


67
68
69
70
71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 67</span>

<span class='kw'>def</span> <span class='id identifier rubyid_enroll_employer_profile'>enroll_employer_profile</span>
  <span class='kw'>if</span> <span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_may_enroll_employer?'>may_enroll_employer?</span>
    <span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_enroll_employer!'>enroll_employer!</span>
  <span class='kw'>elsif</span> <span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_may_force_enroll?'>may_force_enroll?</span>
    <span class='ivar'>@employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_force_enroll!'>force_enroll!</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="terminate_employee_coverage-instance_method">
  
    #<strong>terminate_employee_coverage</strong>(census_employee)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


132
133
134
135
136
137
138
139
140
141
142</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 132</span>

<span class='kw'>def</span> <span class='id identifier rubyid_terminate_employee_coverage'>terminate_employee_coverage</span><span class='lparen'>(</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='rparen'>)</span>
  <span class='kw'>return</span>

  <span class='id identifier rubyid_person'>person</span> <span class='op'>=</span> <span class='id identifier rubyid_match_person'>match_person</span><span class='lparen'>(</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_family'>family</span> <span class='op'>=</span> <span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_primary_family'>primary_family</span>

  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_family'>family</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>

  <span class='id identifier rubyid_cancel_renewals'>cancel_renewals</span><span class='lparen'>(</span><span class='id identifier rubyid_family'>family</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_expire_previous_year_enrollments'>expire_previous_year_enrollments</span><span class='lparen'>(</span><span class='id identifier rubyid_family'>family</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="valid_enrollment?-instance_method">
  
    #<strong>valid_enrollment?</strong>(hbx_enrollment, renewal_enrollment)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129
130</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 126</span>

<span class='kw'>def</span> <span class='id identifier rubyid_valid_enrollment?'>valid_enrollment?</span><span class='lparen'>(</span><span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='comma'>,</span> <span class='id identifier rubyid_renewal_enrollment'>renewal_enrollment</span><span class='rparen'>)</span>
  <span class='comment'># Enable for 1/1 employers
</span>  <span class='comment'># hbx_enrollment.effective_on == renewal_enrollment.effective_on &amp;&amp; hbx_enrollment.effective_on &lt;= TimeKeeper.date_of_record &amp;&amp; hbx_enrollment.updated_at &lt; TimeKeeper.date_of_record.beginning_of_year
</span>  <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_effective_on'>effective_on</span> <span class='op'>==</span> <span class='id identifier rubyid_renewal_enrollment'>renewal_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_effective_on'>effective_on</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_hbx_enrollment'>hbx_enrollment</span><span class='period'>.</span><span class='id identifier rubyid_effective_on'>effective_on</span> <span class='op'>&lt;=</span> <span class='const'><span class='object_link'><a href="../TimeKeeper.html" title="TimeKeeper (class)">TimeKeeper</a></span></span><span class='period'>.</span><span class='id identifier rubyid_date_of_record'><span class='object_link'><a href="../TimeKeeper.html#date_of_record-class_method" title="TimeKeeper.date_of_record (method)">date_of_record</a></span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="waived_benefit_group_assignment-instance_method">
  
    #<strong>waived_benefit_group_assignment</strong>(census_employee)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/factories/plan_year_enroll_factory.rb', line 144</span>

<span class='kw'>def</span> <span class='id identifier rubyid_waived_benefit_group_assignment'>waived_benefit_group_assignment</span><span class='lparen'>(</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='rparen'>)</span>
  <span class='ivar'>@count</span> <span class='op'>=</span> <span class='int'>0</span>

  <span class='id identifier rubyid_person'>person</span> <span class='op'>=</span> <span class='id identifier rubyid_match_person'>match_person</span><span class='lparen'>(</span><span class='id identifier rubyid_census_employee'>census_employee</span><span class='rparen'>)</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_family'>family</span> <span class='op'>=</span> <span class='id identifier rubyid_person'>person</span><span class='period'>.</span><span class='id identifier rubyid_primary_family'>primary_family</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_family'>family</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_enrollments'>enrollments</span> <span class='op'>=</span> <span class='id identifier rubyid_family'>family</span><span class='period'>.</span><span class='id identifier rubyid_active_household'>active_household</span><span class='period'>.</span><span class='id identifier rubyid_hbx_enrollments'>hbx_enrollments</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='label'>effective_on:</span> <span class='lparen'>(</span><span class='ivar'>@start_on</span><span class='op'>..</span><span class='ivar'>@end_on</span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_shop_market'>shop_market</span>
  <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id identifier rubyid_enrollments'>enrollments</span><span class='period'>.</span><span class='id identifier rubyid_renewing'>renewing</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>

  <span class='id identifier rubyid_active_assignment'>active_assignment</span> <span class='op'>=</span> <span class='id identifier rubyid_census_employee'>census_employee</span><span class='period'>.</span><span class='id identifier rubyid_active_benefit_group_assignment'>active_benefit_group_assignment</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_active_assignment'>active_assignment</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
    <span class='id identifier rubyid_active_assignment'>active_assignment</span> <span class='op'>=</span> <span class='id identifier rubyid_census_employee'>census_employee</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_assignments'>benefit_group_assignments</span><span class='period'>.</span><span class='id identifier rubyid_detect'>detect</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_assignment'>assignment</span><span class='op'>|</span> <span class='ivar'>@benefit_group_ids</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span><span class='id identifier rubyid_assignment'>assignment</span><span class='period'>.</span><span class='id identifier rubyid_benefit_group_id'>benefit_group_id</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_enrollments'>enrollments</span><span class='period'>.</span><span class='id identifier rubyid_enrolled'>enrolled</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='id identifier rubyid_active_assignment'>active_assignment</span><span class='period'>.</span><span class='id identifier rubyid_begin_benefit'>begin_benefit</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_enrollments'>enrollments</span><span class='period'>.</span><span class='id identifier rubyid_waived'>waived</span><span class='period'>.</span><span class='id identifier rubyid_any?'>any?</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_active_assignment'>active_assignment</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
      <span class='id identifier rubyid_active_assignment'>active_assignment</span><span class='period'>.</span><span class='id identifier rubyid_waive_benefit'>waive_benefit</span>
      <span class='kw'>return</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  
  <span class='kw'>return</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Oct 11 09:50:28 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.2.3).
</div>

    </div>
  </body>
</html>