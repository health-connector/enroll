<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: Importers::ConversionEmployerUpdate
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "Importers::ConversionEmployerUpdate";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (C)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../Importers.html" title="Importers (module)">Importers</a></span></span>
     &raquo; 
    <span class="title">ConversionEmployerUpdate</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: Importers::ConversionEmployerUpdate
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="ConversionEmployer.html" title="Importers::ConversionEmployer (class)">ConversionEmployer</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="ConversionEmployer.html" title="Importers::ConversionEmployer (class)">ConversionEmployer</a></span></li>
          
            <li class="next">Importers::ConversionEmployerUpdate</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>app/models/importers/conversion_employer_update.rb</dd>
  </dl>
  
</div>







  <h2>Instance Attribute Summary</h2>
  
  <h3 class="inherited">Attributes inherited from <span class='object_link'><a href="ConversionEmployer.html" title="Importers::ConversionEmployer (class)">ConversionEmployer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ConversionEmployer.html#action-instance_method" title="Importers::ConversionEmployer#action (method)">#action</a></span>, <span class='object_link'><a href="ConversionEmployer.html#broker_name-instance_method" title="Importers::ConversionEmployer#broker_name (method)">#broker_name</a></span>, <span class='object_link'><a href="ConversionEmployer.html#broker_npn-instance_method" title="Importers::ConversionEmployer#broker_npn (method)">#broker_npn</a></span>, <span class='object_link'><a href="ConversionEmployer.html#contact_email-instance_method" title="Importers::ConversionEmployer#contact_email (method)">#contact_email</a></span>, <span class='object_link'><a href="ConversionEmployer.html#contact_first_name-instance_method" title="Importers::ConversionEmployer#contact_first_name (method)">#contact_first_name</a></span>, <span class='object_link'><a href="ConversionEmployer.html#contact_last_name-instance_method" title="Importers::ConversionEmployer#contact_last_name (method)">#contact_last_name</a></span>, <span class='object_link'><a href="ConversionEmployer.html#contact_phone-instance_method" title="Importers::ConversionEmployer#contact_phone (method)">#contact_phone</a></span>, <span class='object_link'><a href="ConversionEmployer.html#contact_phone_extension-instance_method" title="Importers::ConversionEmployer#contact_phone_extension (method)">#contact_phone_extension</a></span>, <span class='object_link'><a href="ConversionEmployer.html#dba-instance_method" title="Importers::ConversionEmployer#dba (method)">#dba</a></span>, <span class='object_link'><a href="ConversionEmployer.html#enrolled_employee_count-instance_method" title="Importers::ConversionEmployer#enrolled_employee_count (method)">#enrolled_employee_count</a></span>, <span class='object_link'><a href="ConversionEmployer.html#legal_name-instance_method" title="Importers::ConversionEmployer#legal_name (method)">#legal_name</a></span>, <span class='object_link'><a href="ConversionEmployer.html#mailing_location_address_1-instance_method" title="Importers::ConversionEmployer#mailing_location_address_1 (method)">#mailing_location_address_1</a></span>, <span class='object_link'><a href="ConversionEmployer.html#mailing_location_address_2-instance_method" title="Importers::ConversionEmployer#mailing_location_address_2 (method)">#mailing_location_address_2</a></span>, <span class='object_link'><a href="ConversionEmployer.html#mailing_location_city-instance_method" title="Importers::ConversionEmployer#mailing_location_city (method)">#mailing_location_city</a></span>, <span class='object_link'><a href="ConversionEmployer.html#mailing_location_state-instance_method" title="Importers::ConversionEmployer#mailing_location_state (method)">#mailing_location_state</a></span>, <span class='object_link'><a href="ConversionEmployer.html#mailing_location_zip-instance_method" title="Importers::ConversionEmployer#mailing_location_zip (method)">#mailing_location_zip</a></span>, <span class='object_link'><a href="ConversionEmployer.html#mid_year_conversion-instance_method" title="Importers::ConversionEmployer#mid_year_conversion (method)">#mid_year_conversion</a></span>, <span class='object_link'><a href="ConversionEmployer.html#new_hire_count-instance_method" title="Importers::ConversionEmployer#new_hire_count (method)">#new_hire_count</a></span>, <span class='object_link'><a href="ConversionEmployer.html#primary_location_address_1-instance_method" title="Importers::ConversionEmployer#primary_location_address_1 (method)">#primary_location_address_1</a></span>, <span class='object_link'><a href="ConversionEmployer.html#primary_location_address_2-instance_method" title="Importers::ConversionEmployer#primary_location_address_2 (method)">#primary_location_address_2</a></span>, <span class='object_link'><a href="ConversionEmployer.html#primary_location_city-instance_method" title="Importers::ConversionEmployer#primary_location_city (method)">#primary_location_city</a></span>, <span class='object_link'><a href="ConversionEmployer.html#primary_location_county-instance_method" title="Importers::ConversionEmployer#primary_location_county (method)">#primary_location_county</a></span>, <span class='object_link'><a href="ConversionEmployer.html#primary_location_state-instance_method" title="Importers::ConversionEmployer#primary_location_state (method)">#primary_location_state</a></span>, <span class='object_link'><a href="ConversionEmployer.html#primary_location_zip-instance_method" title="Importers::ConversionEmployer#primary_location_zip (method)">#primary_location_zip</a></span>, <span class='object_link'><a href="ConversionEmployer.html#registered_on-instance_method" title="Importers::ConversionEmployer#registered_on (method)">#registered_on</a></span>, <span class='object_link'><a href="ConversionEmployer.html#warnings-instance_method" title="Importers::ConversionEmployer#warnings (method)">#warnings</a></span></p>


  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#broker_agency_profile-instance_method" title="#broker_agency_profile (instance method)">#<strong>broker_agency_profile</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#employer_profile-instance_method" title="#employer_profile (instance method)">#<strong>employer_profile</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#find_organization-instance_method" title="#find_organization (instance method)">#<strong>find_organization</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_broker_agency_profile_info_changed%3F-instance_method" title="#has_broker_agency_profile_info_changed? (instance method)">#<strong>has_broker_agency_profile_info_changed?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_data_not_changed_since_import-instance_method" title="#has_data_not_changed_since_import (instance method)">#<strong>has_data_not_changed_since_import</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>covered scenarios if broker is hired/terminated, then updated_at column in
employer_profile model is changed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_employer_info_changed%3F-instance_method" title="#has_employer_info_changed? (instance method)">#<strong>has_employer_info_changed?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_office_locations_changed%3F-instance_method" title="#has_office_locations_changed? (instance method)">#<strong>has_office_locations_changed?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#has_organization_info_changed%3F-instance_method" title="#has_organization_info_changed? (instance method)">#<strong>has_organization_info_changed?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(opts = {})  &#x21d2; ConversionEmployerUpdate </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>A new instance of ConversionEmployerUpdate.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save-instance_method" title="#save (instance method)">#<strong>save</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="ConversionEmployer.html" title="Importers::ConversionEmployer (class)">ConversionEmployer</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="ConversionEmployer.html#assign_brokers-instance_method" title="Importers::ConversionEmployer#assign_brokers (method)">#assign_brokers</a></span>, <span class='object_link'><a href="ConversionEmployer.html#assign_general_agencies-instance_method" title="Importers::ConversionEmployer#assign_general_agencies (method)">#assign_general_agencies</a></span>, <span class='object_link'><a href="ConversionEmployer.html#broker_exists_if_specified-instance_method" title="Importers::ConversionEmployer#broker_exists_if_specified (method)">#broker_exists_if_specified</a></span>, <span class='object_link'><a href="ConversionEmployer.html#build_mailing_address-instance_method" title="Importers::ConversionEmployer#build_mailing_address (method)">#build_mailing_address</a></span>, <span class='object_link'><a href="ConversionEmployer.html#build_primary_address-instance_method" title="Importers::ConversionEmployer#build_primary_address (method)">#build_primary_address</a></span>, <span class='object_link'><a href="ConversionEmployer.html#employer_attestation_attributes-instance_method" title="Importers::ConversionEmployer#employer_attestation_attributes (method)">#employer_attestation_attributes</a></span>, <span class='object_link'><a href="ConversionEmployer.html#fein=-instance_method" title="Importers::ConversionEmployer#fein= (method)">#fein=</a></span>, <span class='object_link'><a href="ConversionEmployer.html#find_broker-instance_method" title="Importers::ConversionEmployer#find_broker (method)">#find_broker</a></span>, <span class='object_link'><a href="ConversionEmployer.html#find_ga-instance_method" title="Importers::ConversionEmployer#find_ga (method)">#find_ga</a></span>, <span class='object_link'><a href="ConversionEmployer.html#map_office_locations-instance_method" title="Importers::ConversionEmployer#map_office_locations (method)">#map_office_locations</a></span>, <span class='object_link'><a href="ConversionEmployer.html#map_poc-instance_method" title="Importers::ConversionEmployer#map_poc (method)">#map_poc</a></span>, <span class='object_link'><a href="ConversionEmployer.html#prepend_zeros-instance_method" title="Importers::ConversionEmployer#prepend_zeros (method)">#prepend_zeros</a></span>, <span class='object_link'><a href="ConversionEmployer.html#propagate_errors-instance_method" title="Importers::ConversionEmployer#propagate_errors (method)">#propagate_errors</a></span>, <span class='object_link'><a href="ConversionEmployer.html#update_poc-instance_method" title="Importers::ConversionEmployer#update_poc (method)">#update_poc</a></span>, <span class='object_link'><a href="ConversionEmployer.html#validate_new_fein-instance_method" title="Importers::ConversionEmployer#validate_new_fein (method)">#validate_new_fein</a></span>, <span class='object_link'><a href="ConversionEmployer.html#validate_tpa_if_specified-instance_method" title="Importers::ConversionEmployer#validate_tpa_if_specified (method)">#validate_tpa_if_specified</a></span></p>

  
  
  
  
  
  
  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Etl/ValueParsers.html" title="Etl::ValueParsers (module)">Etl::ValueParsers</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Etl/ValueParsers.html#included-class_method" title="Etl::ValueParsers.included (method)">included</a></span></p>

  
  <div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(opts = {})  &#x21d2; <tt><span class='object_link'><a href="" title="Importers::ConversionEmployerUpdate (class)">ConversionEmployerUpdate</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Returns a new instance of ConversionEmployerUpdate</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


4
5
6</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 4</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_opts'>opts</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="broker_agency_profile-instance_method">
  
    #<strong>broker_agency_profile</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


29
30
31</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 29</span>

<span class='kw'>def</span> <span class='id identifier rubyid_broker_agency_profile'>broker_agency_profile</span>
  <span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:broker_agency_profile</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="employer_profile-instance_method">
  
    #<strong>employer_profile</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


25
26
27</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 25</span>

<span class='kw'>def</span> <span class='id identifier rubyid_employer_profile'>employer_profile</span>
  <span class='id identifier rubyid_find_organization'>find_organization</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:employer_profile</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="find_organization-instance_method">
  
    #<strong>find_organization</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


20
21
22
23</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 20</span>

<span class='kw'>def</span> <span class='id identifier rubyid_find_organization'>find_organization</span>
  <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='id identifier rubyid_fein'>fein</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
  <span class='const'><span class='object_link'><a href="../Organization.html" title="Organization (class)">Organization</a></span></span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:fein</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_fein'>fein</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_broker_agency_profile_info_changed?-instance_method">
  
    #<strong>has_broker_agency_profile_info_changed?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


46
47
48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 46</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_broker_agency_profile_info_changed?'>has_broker_agency_profile_info_changed?</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_broker_agency_profile'>broker_agency_profile</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_broker_agency_profile'>broker_agency_profile</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_broker_agency_profile'>broker_agency_profile</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span>
    <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:broker_agency_profile</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>import cannot be done as broker agency profile was updated on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_data_not_changed_since_import-instance_method">
  
    #<strong>has_data_not_changed_since_import</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>covered scenarios if broker is hired/terminated, then updated_at column in
employer_profile model is changed. if office locations is updated, then
updated_at column in organization model is changed. if employer info is
updated, then updated_at column in employer_profile model is changed. if
broker_agency_profile info is updated, then updated_at column in
broker_agency_profile model is changed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


13
14
15
16
17
18</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 13</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_data_not_changed_since_import'>has_data_not_changed_since_import</span>
  <span class='id identifier rubyid_has_organization_info_changed?'>has_organization_info_changed?</span>
  <span class='id identifier rubyid_has_employer_info_changed?'>has_employer_info_changed?</span>
  <span class='id identifier rubyid_has_office_locations_changed?'>has_office_locations_changed?</span>
  <span class='id identifier rubyid_has_broker_agency_profile_info_changed?'>has_broker_agency_profile_info_changed?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_employer_info_changed?-instance_method">
  
    #<strong>has_employer_info_changed?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


40
41
42
43
44</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 40</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_employer_info_changed?'>has_employer_info_changed?</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span>
    <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:employer_profile</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>import cannot be done as employer updated the info on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_office_locations_changed?-instance_method">
  
    #<strong>has_office_locations_changed?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54
55
56
57
58
59
60
61
62</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 52</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_office_locations_changed?'>has_office_locations_changed?</span>
  <span class='id identifier rubyid_organization'>organization</span> <span class='op'>=</span> <span class='id identifier rubyid_find_organization'>find_organization</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
    <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_office_locations'>office_locations</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_office_location'>office_location</span><span class='op'>|</span>
      <span class='id identifier rubyid_address'>address</span> <span class='op'>=</span> <span class='id identifier rubyid_office_location'>office_location</span><span class='period'>.</span><span class='id identifier rubyid_try'>try</span><span class='lparen'>(</span><span class='symbol'>:address</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span>
        <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:organization</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>import cannot be done as office location was updated on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_address'>address</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="has_organization_info_changed?-instance_method">
  
    #<strong>has_organization_info_changed?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


33
34
35
36
37
38</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 33</span>

<span class='kw'>def</span> <span class='id identifier rubyid_has_organization_info_changed?'>has_organization_info_changed?</span>
  <span class='id identifier rubyid_organization'>organization</span> <span class='op'>=</span> <span class='id identifier rubyid_find_organization'>find_organization</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span> <span class='op'>&gt;</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_created_at'>created_at</span>
    <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:organization</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>import cannot be done as organization info was updated on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_updated_at'>updated_at</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="save-instance_method">
  
    #<strong>save</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114
115
116
117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136
137
138
139</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'app/models/importers/conversion_employer_update.rb', line 64</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save'>save</span>
  <span class='id identifier rubyid_organization'>organization</span> <span class='op'>=</span> <span class='id identifier rubyid_find_organization'>find_organization</span>
  <span class='kw'>begin</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
      <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:fein</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>employer don&#39;t exists with given fein</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_has_data_not_changed_since_import'>has_data_not_changed_since_import</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Processing Update </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_fein'>fein</span><span class='embexpr_end'>}</span><span class='tstring_content'>---Data Sheet# </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_legal_name'>legal_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>---Enroll App# </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_legal_name'>legal_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='const'>Rails</span><span class='period'>.</span><span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_test?'>test?</span>
      <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_legal_name'>legal_name</span> <span class='op'>=</span> <span class='id identifier rubyid_legal_name'>legal_name</span>
      <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_dba'>dba</span> <span class='op'>=</span> <span class='id identifier rubyid_dba'>dba</span>
      <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_office_locations'>office_locations</span> <span class='op'>=</span> <span class='id identifier rubyid_map_office_locations'>map_office_locations</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_broker_npn'>broker_npn</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>
        <span class='id identifier rubyid_broker_exists_if_specified'>broker_exists_if_specified</span>
        <span class='id identifier rubyid_br'>br</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../BrokerRole.html" title="BrokerRole (class)">BrokerRole</a></span></span><span class='period'>.</span><span class='id identifier rubyid_by_npn'><span class='object_link'><a href="../BrokerRole.html#by_npn-class_method" title="BrokerRole.by_npn (method)">by_npn</a></span></span><span class='lparen'>(</span><span class='id identifier rubyid_broker_npn'>broker_npn</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_br'>br</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_broker_agency_accounts'>broker_agency_accounts</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='symbol'>:writing_agent_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_br'>br</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_blank?'>blank?</span>
          <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_broker_agency_accounts'>broker_agency_accounts</span> <span class='op'>=</span> <span class='id identifier rubyid_assign_brokers'>assign_brokers</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>

      <span class='id identifier rubyid_broker'>broker</span> <span class='op'>=</span> <span class='id identifier rubyid_find_broker'>find_broker</span>
      <span class='id identifier rubyid_general_agency'>general_agency</span> <span class='op'>=</span> <span class='id identifier rubyid_find_ga'>find_ga</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_broker'>broker</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_general_agency'>general_agency</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>

        <span class='id identifier rubyid_general_agency_account'>general_agency_account</span> <span class='op'>=</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_general_agency_accounts'>general_agency_accounts</span><span class='period'>.</span><span class='id identifier rubyid_where'>where</span><span class='lparen'>(</span><span class='lbrace'>{</span>
          <span class='symbol'>:general_agency_profile_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_general_agency'>general_agency</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span><span class='comma'>,</span>
          <span class='symbol'>:broker_role_id</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_broker'>broker</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span>
          <span class='rbrace'>}</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_general_agency_account'>general_agency_account</span><span class='period'>.</span><span class='id identifier rubyid_present?'>present?</span>

          <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_general_agency_accounts'>general_agency_accounts</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_account'>account</span><span class='op'>|</span>
            <span class='kw'>if</span> <span class='lparen'>(</span><span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>!=</span> <span class='id identifier rubyid_general_agency_account'>general_agency_account</span><span class='period'>.</span><span class='id identifier rubyid_id'>id</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_active?'>active?</span><span class='rparen'>)</span>
              <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_terminate!'>terminate!</span> <span class='kw'>if</span> <span class='id identifier rubyid_account'>account</span><span class='period'>.</span><span class='id identifier rubyid_may_terminate?'>may_terminate?</span>
            <span class='kw'>end</span>
          <span class='kw'>end</span>

          <span class='id identifier rubyid_general_agency_account'>general_agency_account</span><span class='period'>.</span><span class='id identifier rubyid_update_attributes'>update_attributes</span><span class='lparen'>(</span><span class='symbol'>:aasm_state</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>active</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_general_agency_account'>general_agency_account</span><span class='period'>.</span><span class='id identifier rubyid_inactive?'>inactive?</span>
        <span class='kw'>else</span>
          <span class='kw'>if</span> <span class='id identifier rubyid_new_account'>new_account</span> <span class='op'>=</span> <span class='id identifier rubyid_assign_general_agencies'>assign_general_agencies</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
            <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_general_agency_accounts'>general_agency_accounts</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_ac'>ac</span><span class='op'>|</span> <span class='id identifier rubyid_ac'>ac</span><span class='period'>.</span><span class='id identifier rubyid_terminate!'>terminate!</span> <span class='kw'>if</span> <span class='id identifier rubyid_ac'>ac</span><span class='period'>.</span><span class='id identifier rubyid_may_terminate?'>may_terminate?</span> <span class='rbrace'>}</span>
            <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_general_agency_accounts'>general_agency_accounts</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_new_account'>new_account</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_update_result'>update_result</span> <span class='op'>=</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_update_result'>update_result</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='comment'># if there are errors, then return false.
</span>    <span class='kw'>end</span>

  <span class='kw'>rescue</span> <span class='const'>Mongoid</span><span class='op'>::</span><span class='const'>Errors</span><span class='op'>::</span><span class='const'>UnknownAttribute</span>
    <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='period'>.</span><span class='id identifier rubyid_plan_years'>plan_years</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_py'>py</span><span class='op'>|</span>
      <span class='id identifier rubyid_py'>py</span><span class='period'>.</span><span class='id identifier rubyid_benefit_groups'>benefit_groups</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lbrace'>{</span><span class='op'>|</span><span class='id identifier rubyid_bg'>bg</span><span class='op'>|</span> <span class='id identifier rubyid_bg'>bg</span><span class='period'>.</span><span class='id identifier rubyid_unset'>unset</span><span class='lparen'>(</span><span class='symbol'>:_type</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
    <span class='id identifier rubyid_update_result'>update_result</span> <span class='op'>=</span> <span class='id identifier rubyid_errors'>errors</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FAILED.....</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>begin</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_update_result'>update_result</span>
      <span class='id identifier rubyid_update_poc'>update_poc</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='period'>.</span><span class='id identifier rubyid_employer_profile'>employer_profile</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>FAILED.....</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='id identifier rubyid_organization'>organization</span>
    <span class='id identifier rubyid_propagate_errors'>propagate_errors</span><span class='lparen'>(</span><span class='id identifier rubyid_organization'>organization</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_update_result'>update_result</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Thu Oct 11 09:50:32 2018 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.12 (ruby-2.2.3).
</div>

    </div>
  </body>
</html>