<div class="container">
  <div class="panel col-md-12 col-xs-12">
    <div class="panel-body">
      <div class="row">
        <div class="col-xs-8">
          <h3 class="heading-text mt-0"><%= @reference_plan.name %></h3>
        </div>
        <div class="col-xs-4">
        </div>
      </div>
      <div class="row">
        <table class="table">
          <tbody>
          <tr>
            <th>Type</th>
            <th>Carrier</th>
            <th>Metal Level</th>
            <th>Network</th>
          </tr>
          <tr>
            <td><%= @reference_plan.plan_type.upcase %></td>
            <td><%= @reference_plan.carrier_profile.legal_name %></td>
            <td><%= @reference_plan.metal_level.capitalize %></td>
            <td>Plan Network</td>
          </tr>
          </tbody>
        </table>
      </div>
      <div class="row">
        <h4 class="pl-1">Your Estimated Monthly Cost</h4>
      </div>
      <div class="row">
        <div class="col-xs-4">
          <h2 class="mt-0 heading-text" id="estimatedERCost"><%= number_to_currency(@benefit_group.monthly_employer_contribution_amount) %>
          </h2>
        </div>
        <div class="col-xs-3">
          Estimated monthly cost including all roster employees
        </div>
        <div class="col-xs-2">
          <strong class="mb-1">Min</strong>
          <br />
          <span id="estimatedEEMin"><%= number_to_currency(@plan_cost_service.monthly_min_employee_cost) %>
            </span>
        </div>
        <div class="col-xs-2">
          <strong class="mb-1">Max</strong>
          <br />
          <span id="estimatedEEMax"><%= number_to_currency(@plan_cost_service.monthly_max_employee_cost) %>
            </span>
        </div>
      </div>
    </div>
  </div>
  <% if @benefit_group.dental_reference_plan.present? %>
    <div class="panel col-md-12 col-xs-12">
      <div class="panel-body">
        <div class="row">
          <div class="col-xs-8">
            <h3 class="heading-text mt-0"><%= @dental_reference_plan.name %></h3>
          </div>
          <div class="col-xs-4">
          </div>
        </div>
        <div class="row">
          <table class="table">
            <tbody>
            <tr>
              <th>Type</th>
              <th>Carrier</th>
              <th>Metal Level</th>
              <th>Network</th>
            </tr>
            <tr>
              <td><%= @dental_reference_plan.plan_type.upcase %></td>
              <td><%= @dental_reference_plan.carrier_profile.legal_name %></td>
              <td><%= @dental_reference_plan.metal_level.capitalize %></td>
              <td>Plan Network</td>
            </tr>
            </tbody>
          </table>
        </div>
        <div class="row">
          <h4 class="pl-1">Your Estimated Monthly Cost</h4>
        </div>
        <div class="row">
          <div class="col-xs-4">
            <h2 class="mt-0 heading-text" id="estimatedERCost"><%= number_to_currency(@plan_cost_service.monthly_employer_contribution_amount(@dental_plan)) %>
            </h2>
          </div>
          <div class="col-xs-3">
            Estimated monthly cost including all roster employees
          </div>
          <div class="col-xs-2">
            <strong class="mb-1">Min</strong>
            <br />
            <span id="estimatedEEMin"><%= number_to_currency(@plan_cost_service.monthly_min_employee_cost(@dental_plan)) %>
            </span>
          </div>
          <div class="col-xs-2">
            <strong class="mb-1">Max</strong>
            <br />
            <span id="estimatedEEMax"><%= number_to_currency(@plan_cost_service.monthly_max_employee_cost(@dental_plan)) %>
            </span>
          </div>
        </div>
      </div>
    </div>
  <% end %>
  <div>
    <% employees = @employee_costs.first[:employees] %>
    <table class="ee-costs-table table-wrapper">
      <thead>
      <tr>
        <th style="padding-right: 250px;">Enrollment Options</th>
        <% employees.each do |employee| %>
          <th><%= employee[:name] %></th>
        <% end %>
      </tr>
      </thead>

      <tbody>
      <tr class="employer-row-bg">
        <td style="background: #d6cece;"><strong>Enroll/Waive</strong></td>
        <% employees.each do |employee| %>
          <th><strong><%= employee[:expected_selection]&.humanize %></strong></th>
        <% end %>
      </tr>

      <tr class="employer-row-bg">
        <td style="background: #d6cece;"><strong>Employer Benchmark Contribution <i class="fa fa-info-circle" data-toggle="tooltip" data-placement="right" title="Employer Benchmark Contribution"></i></strong></td>
        <% employees.each do |employee| %>
          <td><strong><%= number_to_currency(employee[:sponsor_contribution_total]) %></strong></td>
        <% end %>
      </tr>

      <% @employee_costs.each do |product_info| %>
        <tr>
          <td><%= "<b>(Reference Plan)</b><br/>".html_safe if @reference_plan.id.eql?(product_info[:product_id]) %><%= product_info[:product_name] %></td>
          <% product_info[:employees].each do |employee| %>
            <td><%= number_to_currency(employee[:employee_contribution_total]) %></td>
          <% end %>
        </tr>
      <% end %>
      </tbody>
    </table>

    <div id="paginator">
      <%= paginate @employee_costs, :param_name => :page %>
    </div>
  </div>
  <div class="pull-left">
    <%= link_to 'Return to Plan Selection', sponsored_benefits.new_organizations_plan_design_proposal_plan_selection_path(@plan_design_proposal), class:'btn btn-primary' %>
  </div>
</div>
</div>

<style type="text/css">
  .ee-costs-table {
      display: block;
      width: 100%;
      table-layout: fixed;
  }

  .ee-costs-table th:first-child, .ee-costs-table td:first-child {
      position: sticky;
      left: 0;
      color: #373737;
      background: white;
  }

  .table-wrapper {
      overflow-x: scroll;
      margin: 0 auto;
  }

  .employer-row-bg {
      background: #d6cece;
  }
</style>
